
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>C++中优先队列的用法 | 飞翔的pig</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Kongdb">
    

    
    <meta name="description" content="C++ STL中的priority_queue的各种用法">
<meta name="keywords" content="C++">
<meta property="og:type" content="article">
<meta property="og:title" content="C++中优先队列的用法">
<meta property="og:url" content="http://yoursite.com/2018/03/02/C++优先队列的用法/index.html">
<meta property="og:site_name" content="飞翔的pig">
<meta property="og:description" content="C++ STL中的priority_queue的各种用法">
<meta property="og:updated_time" content="2018-03-03T02:29:42.627Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="C++中优先队列的用法">
<meta name="twitter:description" content="C++ STL中的priority_queue的各种用法">

    
    <link rel="alternative" href="/atom.xml" title="飞翔的pig" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="飞翔的pig" title="飞翔的pig"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="飞翔的pig">飞翔的pig</a></h1>
				<h2 class="blog-motto">仰望苍穹，脚踏实地</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">首页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:yoursite.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/03/02/C++优先队列的用法/" title="C++中优先队列的用法" itemprop="url">C++中优先队列的用法</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Kongdb" target="_blank" itemprop="author">Kongdb</a>
		
  <p class="article-time">
    <time datetime="2018-03-02T13:23:51.000Z" itemprop="datePublished"> 发表于 2018-03-02</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#什么是优先队列"><span class="toc-number">1.</span> <span class="toc-text">什么是优先队列</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#STL中的priority-queue"><span class="toc-number">2.</span> <span class="toc-text">STL中的priority_queue</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#头文件及命名空间"><span class="toc-number">2.1.</span> <span class="toc-text">头文件及命名空间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#定义"><span class="toc-number">2.2.</span> <span class="toc-text">定义</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#less对象"><span class="toc-number">2.2.1.</span> <span class="toc-text">less对象</span></a></li></ol></li></ol></li></ol>
		
		</div>
		
		<h1 id="什么是优先队列"><a href="#什么是优先队列" class="headerlink" title="什么是优先队列"></a>什么是优先队列</h1><p>要理解一个东西，自然要理清楚其原理，知其然也要知其所以然。<br>之前对于优先队列有一个<a href="../../../../2018/01/05/C++中常见数据结构的实现/#优先队列（堆）">简单的实现</a>，可以参考。</p>
<p>当然，STL中的优先队列要更复杂，功能也要更强大，但基本原理都是一致的。</p>
<h1 id="STL中的priority-queue"><a href="#STL中的priority-queue" class="headerlink" title="STL中的priority_queue"></a>STL中的priority_queue</h1><h2 id="头文件及命名空间"><a href="#头文件及命名空间" class="headerlink" title="头文件及命名空间"></a>头文件及命名空间</h2><p>头文件:<br><figure class="highlight autoit"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div></pre></td></tr></table></figure></p>
<p>命名空间:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">std</span></div></pre></td></tr></table></figure></p>
<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>下面的很多内容参考</p>
<ul>
<li><a href="http://www.cplusplus.com/reference/queue/priority_queue/" target="_blank" rel="external">cplusplus</a></li>
<li><a href="http://en.cppreference.com/w/cpp/container/priority_queue" target="_blank" rel="external">cppreference</a><br>完整定义如下<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">template &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="title">class</span> <span class="title">Container</span> </span>= vector&lt;T&gt;,</div><div class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Compare</span> </span>= less&lt;typename Container::value_type&gt; &gt; <span class="class"><span class="keyword">class</span> <span class="title">priority_queue</span></span>;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>哇塞好长，有三个模板参数，看着都头大。不着急，慢慢细分来看</p>
<ul>
<li>第一个模板参数<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">T</span></span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>这个好理解的，就是类型参数。比如传入int，则表示值为int的优先队列。<br>注意这个参数是必须的。</p>
<ul>
<li>第二个模板参数<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Container</span> = <span class="title">vector</span>&lt;T&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>元素所在的容器类型，Container::value_type必须和T一致。这个当然啦，容器里的元素类型当然要和队列本身元素的类型一致啦。毕竟容器里存放的就是队列里的元素。</p>
<p>这个参数是可选的，那容器本身可以使用哪些元素呢？原文如下</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">The underlying container may be any of the standard container class templates or some other specifically designed container class. The container shall be accessible through random access iterators and support the following operations:</div><div class="line"><span class="function"><span class="title">empty</span><span class="params">()</span></span></div><div class="line"><span class="function"><span class="title">size</span><span class="params">()</span></span></div><div class="line"><span class="function"><span class="title">front</span><span class="params">()</span></span></div><div class="line"><span class="function"><span class="title">push_back</span><span class="params">()</span></span></div><div class="line"><span class="function"><span class="title">pop_back</span><span class="params">()</span></span></div><div class="line"></div><div class="line">The standard container classes vector and deque fulfill these requirements. By default, <span class="keyword">if</span> no container class is specified <span class="keyword">for</span> <span class="selector-tag">a</span> particular priority_queue class instantiation, the standard container vector is used.</div></pre></td></tr></table></figure>
<p>挑重点的说就是，可以自己实现容器类型，需要实现balabala一大堆函数。<br>也可以用STL里的vector和deque，默认是使用std::vector</p>
<p>看了上面优先队列的基本实现就知道，为什么数组是其基本容器了。因为数组和“堆”这种数据结构简直是天造地设的一对哈哈。</p>
<ul>
<li>第三个模板参数<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Compare</span> = <span class="title">less</span>&lt;typename Container::value_type&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>一个可比较的类型参数，下面细细说来。</p>
<p>先说”typename Container::value_type”这种奇怪语法的原因<br>参考<a href="https://www.cnblogs.com/harlanc/p/6661228.html" target="_blank" rel="external">effective c++第42条</a><br>也就是一个C++的准则：如果解析器在模板中碰到了一个内嵌依赖名字，它不会认为这是一个type，除非你告诉它。<br>好了，问题来了。既然Container::value_type必须是T，那为什么这里不直接使用“less&lt; T &gt;”呢？<br>我也不知道了，可能是为了什么一致性考虑吧，当问题留着。</p>
<p>默认参数是带模板参数的less对象，这个less又是什么鬼。</p>
<h3 id="less对象"><a href="#less对象" class="headerlink" title="less对象"></a>less对象</h3><p>参考：<a href="http://www.cplusplus.com/reference/functional/less/" target="_blank" rel="external">less</a></p>
<ul>
<li>头文件<br>functional</li>
<li>命名空间<br>std</li>
<li>官方定义<br>“Function object class for less-than inequality comparison”<br>翻译过来就是用来比较“小于性”的函数对象。</li>
</ul>
<p>怎么理解呢，来看less对象的基本代码实现<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">struct</span> <span class="title">less</span> &#123;</span></div><div class="line">  <span class="function"><span class="keyword">bool</span> <span class="title">operator</span><span class="params">()</span> <span class="params">(<span class="keyword">const</span> T&amp; x, <span class="keyword">const</span> T&amp; y)</span> <span class="keyword">const</span> </span>&#123;<span class="keyword">return</span> x&lt;y;&#125;</div><div class="line">  <span class="keyword">typedef</span> T first_argument_type;</div><div class="line">  <span class="keyword">typedef</span> T second_argument_type;</div><div class="line">  <span class="keyword">typedef</span> <span class="keyword">bool</span> result_type;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>可以看到less对象重载了”()”调用操作符，并且比较两个对象”&lt;”比较的结果。</p>
<p>显然，这就要求T对象本身要支持”&lt;”操作符啦</p>
<ul>
<li>基本使用<br>直接使用<figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">std:</span><span class="symbol">:less&lt;int&gt;</span> lessComp;</div><div class="line">lessComp(<span class="number">5</span>, <span class="number">4</span>);  <span class="regexp">//false</span></div><div class="line">lessComp(<span class="number">4</span>, <span class="number">5</span>);  <span class="regexp">//true</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>作为参数传入sort等函数中，官方例子如下<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// less example</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;     // std::cout</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;functional&gt;   // std::less</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;    // std::sort, std::includes</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</div><div class="line">  <span class="keyword">int</span> foo[]=&#123;<span class="number">10</span>,<span class="number">20</span>,<span class="number">5</span>,<span class="number">15</span>,<span class="number">25</span>&#125;;</div><div class="line">  <span class="keyword">int</span> bar[]=&#123;<span class="number">15</span>,<span class="number">10</span>,<span class="number">20</span>&#125;;</div><div class="line">  <span class="built_in">std</span>::sort (foo, foo+<span class="number">5</span>, <span class="built_in">std</span>::less&lt;<span class="keyword">int</span>&gt;());  <span class="comment">// 5 10 15 20 25</span></div><div class="line">  <span class="built_in">std</span>::sort (bar, bar+<span class="number">3</span>, <span class="built_in">std</span>::less&lt;<span class="keyword">int</span>&gt;());  <span class="comment">//   10 15 20</span></div><div class="line">  <span class="keyword">if</span> (<span class="built_in">std</span>::includes (foo, foo+<span class="number">5</span>, bar, bar+<span class="number">3</span>, <span class="built_in">std</span>::less&lt;<span class="keyword">int</span>&gt;()))</div><div class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"foo includes bar.\n"</span>;</div><div class="line">  <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>好了不多说了，还是继续回到上面的第三个Compare模板参数，来看官方解释<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">A binary predicate that takes two elements (of<span class="built_in"> type </span>T) as arguments <span class="keyword">and</span> returns a bool.</div><div class="line">The expression comp(a,b), where comp is an object of this<span class="built_in"> type </span><span class="keyword">and</span> a <span class="keyword">and</span> b are elements <span class="keyword">in</span> the container, shall return <span class="literal">true</span> <span class="keyword">if</span> a is considered <span class="keyword">to</span> go before b <span class="keyword">in</span> the strict weak ordering the function defines.</div><div class="line">The priority_queue uses this function <span class="keyword">to</span> maintain the elements sorted <span class="keyword">in</span> a way that preserves heap properties (i.e., that the element popped is the last according <span class="keyword">to</span> this strict weak ordering).</div><div class="line">This can be a function pointer <span class="keyword">or</span> a function object, <span class="keyword">and</span> defaults <span class="keyword">to</span> less&lt;T&gt;, which returns the same as applying the less-than operator (a&lt;b).</div></pre></td></tr></table></figure></p>
<p>比较长，一句一句来看</p>
<ol>
<li>一个二进制对象，有两个参数（T类型），并且返回bool值。<br>这个比较好理解</li>
<li>如果在“严格弱序化”的顺序下，a要在b的前面，那么执行”comp(a,b)”表达式时要返回true，其中comp为该比较对象类型，a和b为容器中的元素类型<br>参考<a href="https://www.cnblogs.com/walkerlala/p/5561339.html" target="_blank" rel="external">严格弱序化</a><br>还有一个比较难理解的概念：什么叫a在b的前面(a go before b).<br>参考cppreference中的说明”But because the priority queue outputs largest elements first, the elements that “come before” are actually output last. That is, the front of the queue contains the “last” element according to the weak ordering imposed by Compare.”<br>总结而言就是，如果a在b前面了，那么b先输出，a后输出</li>
<li>优先队列利用该函数来维持元素的有序，从而保持“堆”的性质</li>
<li>该参数可以是一个函数指针或函数对象，默认为less&lt; T&gt;</li>
</ol>
<p>废话说的太多了，还是来几个实例吧</p>
<ul>
<li><p>使用默认值，递减顺序排序输出</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">descendOrder</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">std</span>::priority_queue&lt;<span class="keyword">int</span>&gt; q;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i : &#123;<span class="number">3</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>&#125;)</div><div class="line">        q.push(i);</div><div class="line">    <span class="keyword">while</span>(!q.empty())</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, q.top());   <span class="comment">//7 5 3 2 1</span></div><div class="line">        q.pop();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>使用greater对象，递增顺序排序输出</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">ascendOrder1</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">std</span>::priority_queue&lt;<span class="keyword">int</span>, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;, <span class="built_in">std</span>::greater&lt;<span class="keyword">int</span>&gt;&gt; q;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i : &#123;<span class="number">3</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>&#125;)</div><div class="line">        q.push(i);</div><div class="line">    <span class="keyword">while</span>(!q.empty())</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, q.top());   <span class="comment">//1 2 3 5 7</span></div><div class="line">        q.pop();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>利用函数指针，递增顺序排序输出</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">gCmp</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">return</span> a &gt; b;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">bool</span> <span class="params">(*gCmpPtr)</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">ascendOrder2</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">std</span>::priority_queue&lt;<span class="keyword">int</span>, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;, gCmpPtr&gt; q(gCmp);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i : &#123;<span class="number">3</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>&#125;)</div><div class="line">        q.push(i);</div><div class="line">    <span class="keyword">while</span>(!q.empty())</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, q.top());   <span class="comment">//1 2 3 5 7</span></div><div class="line">        q.pop();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>利用lambda表达式，递增顺序排序输出<br>和上面类似的，只是使用了C++11的lambda</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">ascendOrder3</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">auto</span> cmp = [](<span class="keyword">int</span> a, <span class="keyword">int</span> b) &#123; <span class="keyword">return</span> a &gt; b; &#125;;</div><div class="line">    <span class="built_in">std</span>::priority_queue&lt;<span class="keyword">int</span>, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;, <span class="keyword">decltype</span>(cmp)&gt; q(cmp);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i : &#123;<span class="number">3</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>&#125;)</div><div class="line">        q.push(i);</div><div class="line">    <span class="keyword">while</span>(!q.empty())</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, q.top());   <span class="comment">//1 2 3 5 7</span></div><div class="line">        q.pop();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>自定义对象的排序</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct </span><span class="keyword">CmpObj</span></div><div class="line">&#123;</div><div class="line">    int key<span class="comment">;</span></div><div class="line">    explicit <span class="keyword">CmpObj(int </span>k) : key(k) &#123;&#125;</div><div class="line">&#125;<span class="comment">;</span></div><div class="line"></div><div class="line"><span class="keyword">bool </span>operator &lt; (const <span class="keyword">CmpObj </span>&amp;a, const <span class="keyword">CmpObj </span>&amp;<span class="keyword">b)</span></div><div class="line">&#123;</div><div class="line">    return a.key &lt; <span class="keyword">b.key;</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">bool </span>operator &gt; (const <span class="keyword">CmpObj </span>&amp;a, const <span class="keyword">CmpObj </span>&amp;<span class="keyword">b)</span></div><div class="line">&#123;</div><div class="line">    return a.key &gt; <span class="keyword">b.key;</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="symbol">void</span> testObjCmp()</div><div class="line">&#123;</div><div class="line"><span class="symbol">    std:</span>:priority_queue&lt;<span class="keyword">CmpObj&gt; </span>descendQ<span class="comment">;</span></div><div class="line"><span class="symbol">    std:</span>:priority_queue&lt;<span class="keyword">CmpObj, </span>std::vector&lt;<span class="keyword">CmpObj&gt;,</span></div><div class="line"><span class="symbol">                        std:</span>:greater&lt;<span class="keyword">CmpObj&gt;&gt; </span>ascendQ<span class="comment">;</span></div><div class="line">    for(const auto &amp;obj : &#123;<span class="keyword">CmpObj(3), </span><span class="keyword">CmpObj(1), </span><span class="keyword">CmpObj(2)&#125;)</span></div><div class="line">    &#123;</div><div class="line">        descendQ.<span class="keyword">push(obj);</span></div><div class="line">        ascendQ.<span class="keyword">push(obj);</span></div><div class="line">    &#125;</div><div class="line">    <span class="meta">while</span>(!descendQ.empty())</div><div class="line">    &#123;</div><div class="line">        printf(<span class="string">"%d "</span>, descendQ.top().key)<span class="comment">;  //3 2 1</span></div><div class="line">        descendQ.<span class="keyword">pop();</span></div><div class="line">    &#125;</div><div class="line">    printf(<span class="string">"\n"</span>)<span class="comment">;</span></div><div class="line">    <span class="meta">while</span>(!ascendQ.empty())</div><div class="line">    &#123;</div><div class="line">        printf(<span class="string">"%d "</span>, ascendQ.top().key)<span class="comment">;  //1 2 3</span></div><div class="line">        ascendQ.<span class="keyword">pop();</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>需要对自定义对象重载”&lt;”和”&gt;”操作符，希望逆序输出则重载”&lt;”，希望顺序输出则重载”&gt;”</p>
<ul>
<li>自定义比较Compare对象<br>这个和上面的不一样，这里相当于是自定义第三个模板Compare参数<br>典型的例子是链表指针的比较<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">struct <span class="keyword">Node</span></div><div class="line"><span class="title">&#123;</span></div><div class="line">    int data;</div><div class="line">    <span class="keyword">Node</span> <span class="title">*next</span>;</div><div class="line">    <span class="keyword">Node</span><span class="title">(int</span> d = <span class="number">0</span>, <span class="keyword">Node</span> <span class="title">*n</span> = nullptr) : data(d), next(n) &#123;&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">struct NodePtrCmp</div><div class="line">&#123;</div><div class="line">    //类似于less对象，重载()执行操作符</div><div class="line">    bool operator()(<span class="keyword">Node</span> <span class="title">*pa</span>, <span class="keyword">Node</span> <span class="title">*pb</span>)</div><div class="line">    &#123;</div><div class="line">        return pa-&gt;data &gt; pb-&gt;data;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">void testListCompare()</div><div class="line">&#123;</div><div class="line">    //注意这里容器的元素时指针</div><div class="line">    std::priority_queue<span class="tag">&lt;Node *, std::vector&lt;Node *&gt;</span>, NodePtrCmp&gt; q;</div><div class="line">    for(int i : &#123;<span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>&#125;)</div><div class="line">        q.push(new <span class="keyword">Node</span><span class="title">(i</span>));</div><div class="line">    while(!q.empty())</div><div class="line">    &#123;</div><div class="line">        printf(<span class="string">"%d "</span>, q.top()-&gt;data);   // <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></div><div class="line">        q.pop();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li>
</ul>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/编程/">编程</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/C/">C++</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://yoursite.com/2018/03/02/C++优先队列的用法/" data-title="C++中优先队列的用法 | 飞翔的pig" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2018/03/04/经典算法系列（三）/" title="经典算法系列（三）">
  <strong>上一篇：</strong><br/>
  <span>
  经典算法系列（三）</span>
</a>
</div>


<div class="next">
<a href="/2018/03/01/合并k个有序链表/"  title="合并k个有序链表">
 <strong>下一篇：</strong><br/> 
 <span>合并k个有序链表
</span>
</a>
</div>

</nav>

	


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#什么是优先队列"><span class="toc-number">1.</span> <span class="toc-text">什么是优先队列</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#STL中的priority-queue"><span class="toc-number">2.</span> <span class="toc-text">STL中的priority_queue</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#头文件及命名空间"><span class="toc-number">2.1.</span> <span class="toc-text">头文件及命名空间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#定义"><span class="toc-number">2.2.</span> <span class="toc-text">定义</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#less对象"><span class="toc-number">2.2.1.</span> <span class="toc-text">less对象</span></a></li></ol></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  


  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/《算法导论》/" title="《算法导论》">《算法导论》<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/图解排序算法/" title="图解排序算法">图解排序算法<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/编程/备忘/" title="备忘">备忘<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/常见问题/" title="常见问题">常见问题<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/理财/" title="理财">理财<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/经典算法系列/" title="经典算法系列">经典算法系列<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/编程/" title="编程">编程<sup>29</sup></a></li>
		  
		
		  
			<li><a href="/categories/编程/金融/" title="金融">金融<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/C/" title="C++">C++<sup>20</sup></a></li>
			
		
			
				<li><a href="/tags/Python/" title="Python">Python<sup>11</sup></a></li>
			
		
			
				<li><a href="/tags/算法/" title="算法">算法<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/MySQL/" title="MySQL">MySQL<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/vi/" title="vi">vi<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Linux/" title="Linux">Linux<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/金融/" title="金融">金融<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/C-11/" title="C++11">C++11<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Web/" title="Web">Web<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/数据结构/" title="数据结构">数据结构<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/IRR/" title="IRR">IRR<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/排序算法/" title="排序算法">排序算法<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/设计模式/" title="设计模式">设计模式<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://github.com" target="_blank" title="一个面向开源及私有软件项目的托管平台">Github</a>
            
          </li>
        
          <li>
            
            	<a href="https://hexo.io" target="_blank" title="一个开源的静态博客生成器">Hexo</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">新浪微博</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=null&verifier=b3593ceb&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m kongdb. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/2785742593" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2018 
		
		<a href="/about" target="_blank" title="Kongdb">Kongdb</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>









<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
