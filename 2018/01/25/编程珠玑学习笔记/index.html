
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>编程珠玑学习笔记 | 飞翔的pig</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Kongdb">
    

    
    <meta name="description" content="编程珠玑学习要点记录">
<meta name="keywords" content="C++">
<meta property="og:type" content="article">
<meta property="og:title" content="编程珠玑学习笔记">
<meta property="og:url" content="http://yoursite.com/2018/01/25/编程珠玑学习笔记/index.html">
<meta property="og:site_name" content="飞翔的pig">
<meta property="og:description" content="编程珠玑学习要点记录">
<meta property="og:updated_time" content="2018-03-15T13:03:22.035Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="编程珠玑学习笔记">
<meta name="twitter:description" content="编程珠玑学习要点记录">

    
    <link rel="alternative" href="/atom.xml" title="飞翔的pig" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="飞翔的pig" title="飞翔的pig"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="飞翔的pig">飞翔的pig</a></h1>
				<h2 class="blog-motto">仰望苍穹，脚踏实地</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">首页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:yoursite.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/01/25/编程珠玑学习笔记/" title="编程珠玑学习笔记" itemprop="url">编程珠玑学习笔记</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Kongdb" target="_blank" itemprop="author">Kongdb</a>
		
  <p class="article-time">
    <time datetime="2018-01-25T12:23:51.000Z" itemprop="datePublished"> 发表于 2018-01-25</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#第一章"><span class="toc-number">1.</span> <span class="toc-text">第一章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#开篇题目"><span class="toc-number">1.1.</span> <span class="toc-text">开篇题目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#描述"><span class="toc-number">1.1.1.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解答"><span class="toc-number">1.1.2.</span> <span class="toc-text">解答</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#生成0到n之间k个不同的随机顺序的随机整数"><span class="toc-number">1.2.</span> <span class="toc-text">生成0到n之间k个不同的随机顺序的随机整数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第二章"><span class="toc-number">2.</span> <span class="toc-text">第二章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#问题1"><span class="toc-number">2.1.</span> <span class="toc-text">问题1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#描述-1"><span class="toc-number">2.1.1.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解题思路"><span class="toc-number">2.1.2.</span> <span class="toc-text">解题思路</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#问题2"><span class="toc-number">2.2.</span> <span class="toc-text">问题2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#问题3"><span class="toc-number">2.3.</span> <span class="toc-text">问题3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#描述-2"><span class="toc-number">2.3.1.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解题思路-1"><span class="toc-number">2.3.2.</span> <span class="toc-text">解题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#几点感想"><span class="toc-number">2.3.3.</span> <span class="toc-text">几点感想</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第三章"><span class="toc-number">3.</span> <span class="toc-text">第三章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#k阶常系数方程计算"><span class="toc-number">3.1.</span> <span class="toc-text">k阶常系数方程计算</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#描述-3"><span class="toc-number">3.1.1.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#实现"><span class="toc-number">3.1.2.</span> <span class="toc-text">实现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第四章"><span class="toc-number">4.</span> <span class="toc-text">第四章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#二分搜索的讨论"><span class="toc-number">4.1.</span> <span class="toc-text">二分搜索的讨论</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#实现-1"><span class="toc-number">4.1.1.</span> <span class="toc-text">实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#与chromium源码比较"><span class="toc-number">4.1.2.</span> <span class="toc-text">与chromium源码比较</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第八章"><span class="toc-number">5.</span> <span class="toc-text">第八章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#最大子序列求解问题"><span class="toc-number">5.1.</span> <span class="toc-text">最大子序列求解问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#描述-4"><span class="toc-number">5.1.1.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解答-1"><span class="toc-number">5.1.2.</span> <span class="toc-text">解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#伪代码"><span class="toc-number">5.1.3.</span> <span class="toc-text">伪代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#发散一下"><span class="toc-number">5.1.4.</span> <span class="toc-text">发散一下</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#习题5"><span class="toc-number">5.2.</span> <span class="toc-text">习题5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#习题9"><span class="toc-number">5.3.</span> <span class="toc-text">习题9</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#说明"><span class="toc-number">5.3.1.</span> <span class="toc-text">说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#实现-2"><span class="toc-number">5.3.2.</span> <span class="toc-text">实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#习题10"><span class="toc-number">5.4.</span> <span class="toc-text">习题10</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#说明-1"><span class="toc-number">5.4.1.</span> <span class="toc-text">说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#实现-3"><span class="toc-number">5.4.2.</span> <span class="toc-text">实现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第九章"><span class="toc-number">6.</span> <span class="toc-text">第九章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#顺序搜索"><span class="toc-number">6.1.</span> <span class="toc-text">顺序搜索</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#变形二分搜索：查找数字t在数组中第一次出现的位置"><span class="toc-number">6.2.</span> <span class="toc-text">变形二分搜索：查找数字t在数组中第一次出现的位置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#解决方法"><span class="toc-number">6.2.1.</span> <span class="toc-text">解决方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#宏和函数求最值性能比较"><span class="toc-number">6.3.</span> <span class="toc-text">宏和函数求最值性能比较</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#习题7-求解数的二进制中1的个数"><span class="toc-number">6.4.</span> <span class="toc-text">习题7-求解数的二进制中1的个数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#习题8-查找数组元素的最大值"><span class="toc-number">6.5.</span> <span class="toc-text">习题8-查找数组元素的最大值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#习题12"><span class="toc-number">6.6.</span> <span class="toc-text">习题12</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第10章"><span class="toc-number">7.</span> <span class="toc-text">第10章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-2示例问题"><span class="toc-number">7.1.</span> <span class="toc-text">10.2示例问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#描述-5"><span class="toc-number">7.1.1.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#实现-4"><span class="toc-number">7.1.2.</span> <span class="toc-text">实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#两个对称矩阵的压缩"><span class="toc-number">7.2.</span> <span class="toc-text">两个对称矩阵的压缩</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#描述-6"><span class="toc-number">7.2.1.</span> <span class="toc-text">描述</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第11章-排序"><span class="toc-number">8.</span> <span class="toc-text">第11章-排序</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#插入排序"><span class="toc-number">8.1.</span> <span class="toc-text">插入排序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#快速排序"><span class="toc-number">8.2.</span> <span class="toc-text">快速排序</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第12章"><span class="toc-number">9.</span> <span class="toc-text">第12章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#两个常用函数"><span class="toc-number">9.1.</span> <span class="toc-text">两个常用函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#题目1：输出随机有序列表"><span class="toc-number">9.2.</span> <span class="toc-text">题目1：输出随机有序列表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#习题"><span class="toc-number">9.3.</span> <span class="toc-text">习题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第13章"><span class="toc-number">10.</span> <span class="toc-text">第13章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#习题-1"><span class="toc-number">10.1.</span> <span class="toc-text">习题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第14章"><span class="toc-number">11.</span> <span class="toc-text">第14章</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第15章"><span class="toc-number">12.</span> <span class="toc-text">第15章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#单词"><span class="toc-number">12.1.</span> <span class="toc-text">单词</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#短语"><span class="toc-number">12.2.</span> <span class="toc-text">短语</span></a></li></ol></li></ol>
		
		</div>
		
		<h1 id="第一章"><a href="#第一章" class="headerlink" title="第一章"></a>第一章</h1><h2 id="开篇题目"><a href="#开篇题目" class="headerlink" title="开篇题目"></a>开篇题目</h2><h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>包含n个都小于n且相异的整数，要求排序后输出到另一个文件</p>
<h3 id="解答"><a href="#解答" class="headerlink" title="解答"></a>解答</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTESPERWORD 32</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> SHIFT 5</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MASK 0x1F</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 10000000</span></div><div class="line"><span class="keyword">int</span> <span class="built_in">array</span>[<span class="number">1</span> + N / BYTESPERWORD];</div><div class="line"></div><div class="line"><span class="comment">//精华为下面这三个函数</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">set</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123; <span class="built_in">array</span>[i &gt;&gt; SHIFT] |= (<span class="number">1</span> &lt;&lt; (i &amp; MASK)); &#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">clr</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123; <span class="built_in">array</span>[i &gt;&gt; SHIFT] &amp;= ~(<span class="number">1</span> &lt;&lt; (i &amp; MASK)); &#125;</div><div class="line"><span class="comment">//这里和原书中做了一点小改动，int-&gt;bool，应该没啥影响</span></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">test</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">array</span>[i &gt;&gt; SHIFT] &amp; (<span class="number">1</span> &lt;&lt; (i &amp; MASK)); &#125;</div><div class="line"><span class="comment">//我的理解：</span></div><div class="line"><span class="comment">//1、array长度为什么是[1+N/32]</span></div><div class="line"><span class="comment">//每个int有32个位，每个位为1表示该位置对应的数存在。则每个int可以表示32个数是否存在。</span></div><div class="line"><span class="comment">//额外加1是因为，比如表示33个数则需要2个int值</span></div><div class="line"><span class="comment">//2、i &gt;&gt; SHIFT什么意思</span></div><div class="line"><span class="comment">//相当于i/(2e5)即i/32，表示数字i对应的比特位，在数组中的第i/32个数中。</span></div><div class="line"><span class="comment">//比如数31对应的比特位在第一个数的最后一个比特位上；数32对应的比特位在第二个数的第一个比特位上</span></div><div class="line"><span class="comment">//3、(1 &lt;&lt; (i &amp; MASK))什么意思</span></div><div class="line"><span class="comment">//其中(i &amp; MASK)即i%32，所以原表达式表示32个位中第(i%32)个位为1，其他位全为0</span></div><div class="line"><span class="comment">//比如数31得到的值为10000000000000000000000000000000</span></div><div class="line"><span class="comment">//数32得到的值为00000000000000000000000000000001</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">setDataFromFile</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *fname)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">std</span>::<span class="function">ifstream <span class="title">infile</span><span class="params">(fname)</span></span>;</div><div class="line">    <span class="keyword">if</span>(!infile)</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">int</span> data;</div><div class="line">    <span class="keyword">while</span>(!infile.eof())</div><div class="line">    &#123;</div><div class="line">        infile &gt;&gt; data;</div><div class="line">        <span class="built_in">set</span>(data);</div><div class="line">    &#125;</div><div class="line">    infile.close();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">saveDataToFile</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *fname)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">std</span>::<span class="function">ofstream <span class="title">outfile</span><span class="params">(fname)</span></span>;</div><div class="line">    <span class="keyword">if</span>(outfile.is_open())</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(test(i))</div><div class="line">                outfile &lt;&lt; i &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</div><div class="line">        &#125;</div><div class="line">        outfile.close();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</div><div class="line">        clr(i);</div><div class="line">    setDataFromFile(<span class="string">"in.txt"</span>);</div><div class="line">    saveDataToFile(<span class="string">"out.txt"</span>);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="生成0到n之间k个不同的随机顺序的随机整数"><a href="#生成0到n之间k个不同的随机顺序的随机整数" class="headerlink" title="生成0到n之间k个不同的随机顺序的随机整数"></a>生成0到n之间k个不同的随机顺序的随机整数</h2><p>难点在“不同”二字，伪代码如下<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> <span class="selector-tag">i</span> = [<span class="number">0</span>,n)</div><div class="line">    x[i] = <span class="selector-tag">i</span></div><div class="line"><span class="keyword">for</span> <span class="selector-tag">i</span> = [<span class="number">0</span>,k)</div><div class="line">    swap(<span class="selector-tag">i</span>, randint(<span class="selector-tag">i</span>, n-<span class="number">1</span>))</div><div class="line">    print x[i]</div></pre></td></tr></table></figure></p>
<p>注意到每次随机index的下界i都在递增，保证了不会出现重复的数。精妙</p>
<h1 id="第二章"><a href="#第二章" class="headerlink" title="第二章"></a>第二章</h1><h2 id="问题1"><a href="#问题1" class="headerlink" title="问题1"></a>问题1</h2><h3 id="描述-1"><a href="#描述-1" class="headerlink" title="描述"></a>描述</h3><p>给定一个最多包含40亿个随机排列的32位整数的顺序文件，找出一个不在文件中的32位整数（在文件中至少缺少一个这样的数为什么）</p>
<h3 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h3><ul>
<li>首先为什么至少缺少这样一个数</li>
</ul>
<p>因为2的32次方比40亿略大，即整数的每一位0、1互换，能表示40亿多个整数。</p>
<p>所以肯定至少缺少一个这样的数哦。</p>
<ul>
<li>读入40亿个整数，起始位为0的写入文件A，为1的写入文件B</li>
<li>A,B中有一个文件最多包含20亿个整数，选择这个文件继续</li>
<li>依次类推，总的运行时间正比于n</li>
</ul>
<h2 id="问题2"><a href="#问题2" class="headerlink" title="问题2"></a>问题2</h2><p>参考<a href="../../../../2018/01/27/循环移位问题解析">循环移位问题解析</a></p>
<h2 id="问题3"><a href="#问题3" class="headerlink" title="问题3"></a>问题3</h2><h3 id="描述-2"><a href="#描述-2" class="headerlink" title="描述"></a>描述</h3><p>给定一个英语词典，找出其中所有的变位词集合。例如“pots”，“stop”，“tops”<br>互为变位词。因为每一个单词都可以通过改变其他单词中字母的顺序来得到</p>
<h3 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">pans             anps pans            anps pans</div><div class="line">pots             opst pots            anps snap    pans snap</div><div class="line"><span class="keyword">opt</span>  -&gt;[<span class="keyword">sign</span>] -&gt;  <span class="keyword">opt</span> <span class="keyword">opt</span>  -&gt; <span class="keyword">sort</span> -&gt;  <span class="keyword">opt</span> <span class="keyword">opt</span>  -&gt;   <span class="keyword">opt</span></div><div class="line">snap             anps snap            opst pots   pots <span class="keyword">stop</span> tops</div><div class="line"><span class="keyword">stop</span>             opst <span class="keyword">stop</span>            opst <span class="keyword">stop</span></div><div class="line">tops             opst tops            opst tops</div></pre></td></tr></table></figure>
<ul>
<li>输入文件经过sign标识文件后，每一行增加一个sign标识</li>
</ul>
<p>其中sign程序如下<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line"><span class="comment">//原书：</span></div><div class="line"><span class="comment">//int charcomp(char *x, char *y)</span></div><div class="line"><span class="comment">//&#123; return *x - *y;&#125;</span></div><div class="line"><span class="comment">//使用cl.exe直接编译时有error，这里简单修改了一下</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">charcomp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *x, <span class="keyword">const</span> <span class="keyword">void</span> *y)</span></span></div><div class="line">&#123; <span class="keyword">return</span> *(<span class="keyword">const</span> <span class="keyword">char</span> *)x - *(<span class="keyword">const</span> <span class="keyword">char</span> *)y; &#125;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> WORDMAX 100</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">char</span> word[WORDMAX], sig[WORDMAX];</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%s"</span>, word) != EOF)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">strcpy</span>(sig, word);</div><div class="line">        qsort(sig, <span class="built_in">strlen</span>(sig), <span class="keyword">sizeof</span>(<span class="keyword">char</span>), charcomp);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%s %s\n"</span>, sig, word);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>系统sort程序对sign标识进行排序，从而得到有序的输出</li>
</ul>
<p>sort程序为系统程序</p>
<ul>
<li>squash程序根据标识的异同将相应的单词输出</li>
</ul>
<p>程序实现如下<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> WORDMAX 100</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">char</span> word[WORDMAX], sig[WORDMAX], oldsig[WORDMAX];</div><div class="line">    <span class="built_in">strcpy</span>(oldsig, <span class="string">""</span>);</div><div class="line">    <span class="keyword">int</span> linenum = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%s %s"</span>, sig, word) != EOF)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(<span class="built_in">strcmp</span>(oldsig, sig) != <span class="number">0</span> &amp;&amp; linenum &gt; <span class="number">0</span>)</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">        <span class="built_in">strcpy</span>(oldsig, sig);</div><div class="line">        linenum++;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%s "</span>, word);  </div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>命令行执行命令<figure class="highlight coq"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sign &lt;dictonary | <span class="type">sort</span> | <span class="type">squash</span>&gt; gramlist</div></pre></td></tr></table></figure>
</li>
</ul>
<p>其中dictionary文件可以从这找<a href="https://raw.githubusercontent.com/dwyl/english-words/master/words.txt" target="_blank" rel="external">words.txt</a></p>
<h3 id="几点感想"><a href="#几点感想" class="headerlink" title="几点感想"></a>几点感想</h3><ul>
<li>原来scanf还能这么玩，从文件得到输出</li>
<li>原来系统还有sort这样的程序可以调用。如果没有的话感觉还是比较难将文件内容排序的。</li>
<li>原来一个程序的printf可以作为另一个程序的scanf。</li>
</ul>
<p>才疏学浅啊。</p>
<h1 id="第三章"><a href="#第三章" class="headerlink" title="第三章"></a>第三章</h1><p>数据决定程序结构</p>
<h2 id="k阶常系数方程计算"><a href="#k阶常系数方程计算" class="headerlink" title="k阶常系数方程计算"></a>k阶常系数方程计算</h2><h3 id="描述-3"><a href="#描述-3" class="headerlink" title="描述"></a>描述</h3><p>a<sub>n</sub> = c<sub>1</sub>a<sub>n-1</sub> + c<sub>2</sub>a<sub>n-2</sub> + … + c<sub>k</sub>a<sub>n-k</sub> + c<sub>k+1</sub><br>其中c为常数，编写程序，输入为k，a<sub>1</sub>,…a<sub>k</sub>,c<sub>1</sub>,…c<sub>k+1</sub>和n，输出a<sub>1</sub>至a<sub>m</sub></p>
<h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><p>书中没有实现，想了递归和非递归两种方法<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> K 15</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 20</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> arrayA[N + <span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> arrayC[K + <span class="number">2</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">A_recursive</span><span class="params">(<span class="keyword">int</span> n)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(n &lt;= K)</div><div class="line">        <span class="keyword">return</span> arrayA[n];</div><div class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; ++i)</div><div class="line">        sum += arrayC[i] * A_recursive(n - i);</div><div class="line">    sum += arrayC[K + <span class="number">1</span>];</div><div class="line">    <span class="keyword">return</span> sum;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//这里其实可以优化，因为算a[16]时已经计算</span></div><div class="line"><span class="comment">//而算a[18]时又把a[16]计算了一把</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">A_normal</span><span class="params">(<span class="keyword">int</span> n)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(n &gt; K)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = K + <span class="number">1</span>; i &lt;= n; ++i)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">int</span> temp = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= K; ++j)</div><div class="line">                temp += arrayC[j] * arrayA[i - j];</div><div class="line">            arrayA[i] = temp + arrayC[K + <span class="number">1</span>];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> arrayA[n];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; ++i)</div><div class="line">        arrayA[i] = i + <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K + <span class="number">1</span>; ++i)</div><div class="line">        arrayC[i] = K + <span class="number">1</span> - i;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, A_recursive(<span class="number">16</span>));</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, A_normal(<span class="number">16</span>));</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, A_recursive(<span class="number">18</span>));</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, A_normal(<span class="number">18</span>));</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="第四章"><a href="#第四章" class="headerlink" title="第四章"></a>第四章</h1><h2 id="二分搜索的讨论"><a href="#二分搜索的讨论" class="headerlink" title="二分搜索的讨论"></a>二分搜索的讨论</h2><h3 id="实现-1"><a href="#实现-1" class="headerlink" title="实现"></a>实现</h3><p>实现了一把，考虑了泛型，可以同时比较整形，浮点，字符串等。<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><span class="keyword">int</span> binarySearch(T <span class="keyword">array</span>[], <span class="keyword">int</span> <span class="built_in">size</span>, T data, <span class="keyword">int</span>(*cmp)(T, T))</div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> <span class="built_in">begin</span> = <span class="number">0</span>, <span class="built_in">end</span> = <span class="built_in">size</span> - <span class="number">1</span>;</div><div class="line">    <span class="built_in">while</span>(<span class="built_in">begin</span> &lt;= <span class="built_in">end</span>)</div><div class="line">    &#123;   </div><div class="line">        <span class="keyword">int</span> mid = (<span class="built_in">begin</span> + <span class="built_in">end</span>) / <span class="number">2</span>;</div><div class="line">        <span class="keyword">int</span> result = cmp(<span class="keyword">array</span>[mid], data);</div><div class="line">        <span class="built_in">if</span>(result == <span class="number">0</span>)</div><div class="line">            <span class="built_in">return</span> mid;</div><div class="line">        <span class="built_in">else</span> <span class="built_in">if</span>(result &lt; <span class="number">0</span>)</div><div class="line">            <span class="built_in">begin</span> = mid + <span class="number">1</span>;</div><div class="line">        <span class="built_in">else</span></div><div class="line">            <span class="built_in">end</span> = mid - <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">return</span> <span class="number">-1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> intCompare(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</div><div class="line">&#123;</div><div class="line">    <span class="built_in">return</span> a - b;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> PRECISION 1e-9</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> doubleCompare(<span class="keyword">double</span> a, <span class="keyword">double</span> b)</div><div class="line">&#123;</div><div class="line">    <span class="built_in">if</span>(((a - b) &gt; -PRECISION) &amp;&amp; ((a - b) &lt; PRECISION))</div><div class="line">        <span class="built_in">return</span> <span class="number">0</span>;</div><div class="line">    <span class="built_in">else</span> <span class="built_in">if</span>(a &gt; b)</div><div class="line">        <span class="built_in">return</span> <span class="number">1</span>;</div><div class="line">    <span class="built_in">else</span></div><div class="line">        <span class="built_in">return</span> <span class="number">-1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> strCompare(<span class="keyword">char</span> *a, <span class="keyword">char</span> *b)</div><div class="line">&#123;</div><div class="line">    <span class="built_in">while</span>(*a &amp;&amp; *b &amp;&amp; *a == *b)</div><div class="line">    &#123;</div><div class="line">        ++a;</div><div class="line">        ++b;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">return</span> *a - *b;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> main()</div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> intArray[] = &#123;<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">30</span>&#125;;</div><div class="line">    </div><div class="line">    <span class="keyword">int</span> result = binarySearch(intArray, <span class="keyword">sizeof</span>(intArray)/<span class="keyword">sizeof</span>(<span class="keyword">int</span>),</div><div class="line">                               <span class="number">4</span>, intCompare);</div><div class="line">    printf(<span class="string">"int result :%d\n"</span>, result);</div><div class="line"></div><div class="line">    <span class="keyword">char</span> *strArray[] = &#123;<span class="string">"I"</span>, <span class="string">"Love"</span>, <span class="string">"Money"</span>&#125;;</div><div class="line">    result = binarySearch&lt;<span class="keyword">char</span> *&gt;(strArray, <span class="keyword">sizeof</span>(strArray)/<span class="keyword">sizeof</span>(<span class="keyword">char</span>*),</div><div class="line">                          <span class="string">"Love1"</span>, strCompare);</div><div class="line">    printf(<span class="string">"str result :%d\n"</span>, result);</div><div class="line"></div><div class="line">    <span class="keyword">double</span> doubleArray[] = &#123;<span class="number">3.14</span>, <span class="number">4.12</span>, <span class="number">6.00</span>, <span class="number">7.15</span>&#125;;</div><div class="line">    result = binarySearch(doubleArray, <span class="keyword">sizeof</span>(doubleArray)/<span class="keyword">sizeof</span>(<span class="keyword">float</span>),</div><div class="line">                          <span class="number">6.0</span>, doubleCompare);</div><div class="line">    printf(<span class="string">"float result :%d\n"</span>, result);</div><div class="line"></div><div class="line">    <span class="built_in">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>2018-03-15更新<br>函数原型声明为如下，更为合理<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Compare&gt;</div><div class="line"><span class="keyword">int</span> binarySearch(T <span class="keyword">array</span>[], <span class="keyword">int</span> <span class="built_in">size</span>, T data, Compare cmp)</div></pre></td></tr></table></figure></p>
<p>调用的话还是和之前一样。</p>
<p>这才是泛型编程常用的声明形式。</p>
<h3 id="与chromium源码比较"><a href="#与chromium源码比较" class="headerlink" title="与chromium源码比较"></a>与chromium源码比较</h3><p>在chromium源码中以binarysearch为关键字搜索到了几处</p>
<ul>
<li><p>javascript<br>/chromium/chrome/common/extensions/docs/examples/api/downloads/download_manager/popup.js</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">binarySearch</span><span class="params">(array, target, cmp)</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> low = <span class="number">0</span>, high = <span class="keyword">array</span>.length - <span class="number">1</span>, i, comparison;</div><div class="line">    <span class="keyword">while</span> (low &lt;= high) &#123;</div><div class="line">        i = (low + high) &gt;&gt; <span class="number">1</span>;</div><div class="line">        comparison = cmp(target, <span class="keyword">array</span>[i]);</div><div class="line">        <span class="keyword">if</span> (comparison &lt; <span class="number">0</span>) &#123;</div><div class="line">            low = i + <span class="number">1</span>;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (comparison &gt; <span class="number">0</span>) &#123;</div><div class="line">            high = i - <span class="number">1</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> i;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> i; <span class="comment">//这里为什么要返回i，没搞懂</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
<li><p>JAVA<br>/chromium/third_party/protobuf/javanano/src/main/java/com/google/protobuf/nano/FieldArray.java</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">binarySearch</span>(<span class="params"><span class="keyword">int</span> <span class="keyword">value</span></span>) </span>&#123;</div><div class="line">    <span class="keyword">int</span> lo = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> hi = mSize - <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (lo &lt;= hi) &#123;</div><div class="line">        <span class="keyword">int</span> mid = (lo + hi) &gt;&gt;&gt; <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> midVal = mFieldNumbers[mid];</div><div class="line">        <span class="keyword">if</span> (midVal &lt; <span class="keyword">value</span>) &#123;</div><div class="line">            lo = mid + <span class="number">1</span>;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (midVal &gt; <span class="keyword">value</span>) &#123;</div><div class="line">            hi = mid - <span class="number">1</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> mid; <span class="comment">// value found</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ~lo; <span class="comment">// value not present</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>C++<br>/chromium/third_party/harfbuzz-ng/src/hb-open-type-private.hh</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> SearchType&gt;</div><div class="line"><span class="keyword">inline</span> <span class="keyword">int</span> bsearch (<span class="keyword">const</span> SearchType &amp;x) <span class="keyword">const</span></div><div class="line">&#123;</div><div class="line"><span class="comment">/* Hand-coded bsearch here since this is in the hot inner loop. */</span></div><div class="line"><span class="keyword">const</span> Type *<span class="keyword">array</span> = <span class="keyword">this</span>-&gt;<span class="keyword">array</span>;</div><div class="line"><span class="keyword">int</span> <span class="built_in">min</span> = <span class="number">0</span>, <span class="built_in">max</span> = (<span class="keyword">int</span>) <span class="keyword">this</span>-&gt;len - <span class="number">1</span>;</div><div class="line"><span class="built_in">while</span> (<span class="built_in">min</span> &lt;= <span class="built_in">max</span>)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> mid = (<span class="built_in">min</span> + <span class="built_in">max</span>) / <span class="number">2</span>;</div><div class="line">    <span class="keyword">int</span> c = <span class="keyword">array</span>[mid].cmp (x);</div><div class="line">    <span class="built_in">if</span> (c &lt; <span class="number">0</span>)</div><div class="line">        <span class="built_in">max</span> = mid - <span class="number">1</span>;</div><div class="line">    <span class="built_in">else</span> <span class="built_in">if</span> (c &gt; <span class="number">0</span>)</div><div class="line">        <span class="built_in">min</span> = mid + <span class="number">1</span>;</div><div class="line">    <span class="built_in">else</span></div><div class="line">        <span class="built_in">return</span> mid;</div><div class="line">&#125;</div><div class="line"><span class="built_in">return</span> <span class="number">-1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>可以看到js和C++也是使用了泛型编程。一点感想</p>
<p>前两者都是使用右移而没有使用除法，这个以后要注意。</p>
<h1 id="第八章"><a href="#第八章" class="headerlink" title="第八章"></a>第八章</h1><h2 id="最大子序列求解问题"><a href="#最大子序列求解问题" class="headerlink" title="最大子序列求解问题"></a>最大子序列求解问题</h2><h3 id="描述-4"><a href="#描述-4" class="headerlink" title="描述"></a>描述</h3><p>比如序列{31, -41, 59, 26, -53, 58, 97, -93, -23, 84}</p>
<p>最大子序列和为x[2…6]，即187</p>
<h3 id="解答-1"><a href="#解答-1" class="headerlink" title="解答"></a>解答</h3><p>在《数据结构与算法分析》2.4节也有相应描述，解答如下</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxSubSum</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;a)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> maxSum = <span class="number">0</span>, thisSum = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; a.size(); ++j)</div><div class="line">    &#123;</div><div class="line">        thisSum += a[j];</div><div class="line">        <span class="keyword">if</span>(thisSum &gt; maxSum)</div><div class="line">            maxSum = thisSum;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(thisSum &lt; <span class="number">0</span>)</div><div class="line">            thisSum = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> maxSum;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="伪代码"><a href="#伪代码" class="headerlink" title="伪代码"></a>伪代码</h3><p>本书中给出的伪代码<br><figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="attr">maxsofar</span> = <span class="number">0</span></div><div class="line"><span class="attr">maxendinghere</span> = <span class="number">0</span></div><div class="line">for <span class="attr">i</span> = [<span class="number">0</span>, n)</div><div class="line">    <span class="comment">/*invariant: maxending and maxsofar are accurate for x[0..i-1]*/</span></div><div class="line">    <span class="attr">maxendinghere</span> = max(maxendinghere + x[i], <span class="number">0</span>)</div><div class="line">    <span class="attr">maxsofar</span> = max(maxsofar, maxendinghere)</div></pre></td></tr></table></figure></p>
<p>可以看出，说的是一个意思</p>
<h3 id="发散一下"><a href="#发散一下" class="headerlink" title="发散一下"></a>发散一下</h3><p>如果需要求出最大序列具体的起止索引呢。参考上面的做法，稍微修改了一下</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxSubSum</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;a)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> maxSum = <span class="number">0</span>, thisSum = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> from = <span class="number">0</span>, to = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; a.size(); ++j)</div><div class="line">    &#123;</div><div class="line">        thisSum += a[j];</div><div class="line">        <span class="keyword">if</span>(thisSum &gt; maxSum)</div><div class="line">        &#123;</div><div class="line">            maxSum = thisSum;</div><div class="line">            <span class="comment">//最大序列变化了，终止节点也相应变化</span></div><div class="line">            to = j;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(thisSum &lt; <span class="number">0</span>)</div><div class="line">        &#123;</div><div class="line">            <span class="comment">//这里from从下一个节点开始算</span></div><div class="line">            from = j + <span class="number">1</span>;</div><div class="line">            thisSum = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"from :%d, to:%d\n"</span>, from, to);</div><div class="line">    <span class="keyword">return</span> maxSum;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="习题5"><a href="#习题5" class="headerlink" title="习题5"></a>习题5</h2><p>如何处理cumarr[-1]<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="type">float</span> realarr[] = &#123;<span class="number">1.0</span>, <span class="number">3.0</span>, <span class="number">2.0</span>&#125;;</div><div class="line"><span class="type">float</span> *cumarr = realarr + <span class="number">1</span>;</div><div class="line">printf(<span class="string">"%f<span class="subst">\n</span>"</span>, cumarr[<span class="number">-1</span>]); <span class="comment">//1.0</span></div></pre></td></tr></table></figure></p>
<h2 id="习题9"><a href="#习题9" class="headerlink" title="习题9"></a>习题9</h2><h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>原题中将负数组的最大子序列和定义为0，即空序列，现在将其定义为数组中的最大值。</p>
<p>比如数组为[-3, -2, -1, -9]，按照上面的做法，得出的maxSum为0.现在要求值为-1。</p>
<h3 id="实现-2"><a href="#实现-2" class="headerlink" title="实现"></a>实现</h3><p>只需要将maxSum的初始值设为array[0]即可</p>
<p>为什么呢？</p>
<p>我这么理解，对于一个全负数组，每次循环都会走到[thisSum=0]，所以每次thisSum就</p>
<p>代表了arr[i]的值，这样原函数就退化为了求数组最大值的函数咯</p>
<h2 id="习题10"><a href="#习题10" class="headerlink" title="习题10"></a>习题10</h2><h3 id="说明-1"><a href="#说明-1" class="headerlink" title="说明"></a>说明</h3><p>原题修改为查找总和最接近实数t的向量</p>
<h3 id="实现-3"><a href="#实现-3" class="headerlink" title="实现"></a>实现</h3><p>以t为0为例，即查找总和最接近0的向量</p>
<ul>
<li>初始化累加数组cum，使得cum[i] = x[0] + … + x[i]</li>
<li>拷贝cum数组到临时数组cumtemp，并排序数组cumtemp</li>
<li>查找最接近的两项，这里书上没说怎么做，我想的做法是<br>– 建立临时数组arr，<br>– 从下标1开始，arr[i] = cumtemp[i] - cumtemp[i - 1]，注意到cum是已排序过的，所以arr每个值都不小于0<br>– 查找arr中的最小值对应的index<br>– 则cumtemp[index - 1]和cumtemp[index]是最接近的两项</li>
<li>根据最接近两项的值，再原cum数组中查找具体的leftIndex和rightIndex</li>
<li>则[leftIndex + 1, rightIndex]即为和最接近0的向量</li>
</ul>
<p>感觉太啰嗦了<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">void</span> swap(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> &amp;b)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> t = a;</div><div class="line">    a = b;</div><div class="line">    b = t;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> qsort(<span class="keyword">int</span> *<span class="keyword">array</span>, <span class="keyword">int</span> <span class="built_in">begin</span>, <span class="keyword">int</span> <span class="built_in">end</span>)</div><div class="line">&#123;</div><div class="line">    <span class="built_in">if</span>(<span class="built_in">begin</span> &gt;= <span class="built_in">end</span>)</div><div class="line">        <span class="built_in">return</span>;</div><div class="line">    <span class="keyword">int</span> i = <span class="built_in">begin</span>, j = <span class="built_in">end</span>;</div><div class="line">    swap(<span class="keyword">array</span>[<span class="built_in">begin</span>], <span class="keyword">array</span>[(<span class="built_in">begin</span> + <span class="built_in">end</span>) / <span class="number">2</span>]);</div><div class="line">    <span class="keyword">int</span> curData = <span class="keyword">array</span>[<span class="built_in">begin</span>];</div><div class="line">    <span class="built_in">while</span>(i &lt; j)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">while</span>(i &lt; j &amp;&amp; <span class="keyword">array</span>[j] &gt;= curData)</div><div class="line">            --j;</div><div class="line">        <span class="built_in">while</span>(i &lt; j &amp;&amp; <span class="keyword">array</span>[i] &lt;= curData)</div><div class="line">            ++i;</div><div class="line">        <span class="built_in">if</span>(i &lt; j)</div><div class="line">            swap(<span class="keyword">array</span>[i], <span class="keyword">array</span>[j]);</div><div class="line">    &#125;</div><div class="line">    swap(<span class="keyword">array</span>[i], <span class="keyword">array</span>[<span class="built_in">begin</span>]);</div><div class="line"></div><div class="line">    qsort(<span class="keyword">array</span>, <span class="built_in">begin</span>, i - <span class="number">1</span>);</div><div class="line">    qsort(<span class="keyword">array</span>, i + <span class="number">1</span>, <span class="built_in">end</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> findMinIndex(<span class="keyword">int</span> *cumarr, <span class="keyword">int</span> <span class="built_in">size</span>, <span class="keyword">int</span> t, <span class="keyword">int</span> &amp;left, <span class="keyword">int</span> &amp;right)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> *subarr = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="built_in">size</span>];</div><div class="line">    <span class="built_in">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="built_in">size</span>; ++i)</div><div class="line">        subarr[i] = <span class="built_in">abs</span>(cumarr[i] - cumarr[i - <span class="number">1</span>] - t);</div><div class="line">    <span class="keyword">int</span> minIndex = <span class="number">1</span>, minVal = subarr[<span class="number">1</span>];</div><div class="line">    <span class="built_in">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; <span class="built_in">size</span>; ++i)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">if</span>(subarr[i] &lt; minVal)</div><div class="line">        &#123;</div><div class="line">            minIndex = i;</div><div class="line">            minVal = subarr[i];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    left = cumarr[minIndex - <span class="number">1</span>];</div><div class="line">    right = cumarr[minIndex];      </div><div class="line">    <span class="keyword">delete</span> []subarr;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> findIndex(<span class="keyword">int</span> *arr, <span class="keyword">int</span> <span class="built_in">size</span>, <span class="keyword">int</span> data, <span class="keyword">bool</span> reverse = false)</div><div class="line">&#123;</div><div class="line">    <span class="built_in">if</span>(reverse)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">for</span>(<span class="keyword">int</span> i = <span class="built_in">size</span> - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</div><div class="line">            <span class="built_in">if</span>(data == arr[i])</div><div class="line">                <span class="built_in">return</span> i;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">else</span></div><div class="line">    &#123;</div><div class="line">        <span class="built_in">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">size</span>; ++i)</div><div class="line">            <span class="built_in">if</span>(data == arr[i])</div><div class="line">                <span class="built_in">return</span> i;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">return</span> <span class="number">-1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> findMostNear(<span class="keyword">int</span> *<span class="keyword">array</span>, <span class="keyword">int</span> <span class="built_in">size</span>, <span class="keyword">int</span> t)</div><div class="line">&#123;</div><div class="line">    <span class="built_in">if</span>(<span class="built_in">size</span> &lt;= <span class="number">1</span>)</div><div class="line">        <span class="built_in">return</span>;</div><div class="line">    <span class="keyword">int</span> *cumarr = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="built_in">size</span>], *cumtemp = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="built_in">size</span>];</div><div class="line">    cumarr[<span class="number">0</span>] = cumtemp[<span class="number">0</span>] = <span class="keyword">array</span>[<span class="number">0</span>];</div><div class="line">    <span class="built_in">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="built_in">size</span>; ++i)</div><div class="line">        cumarr[i] = cumtemp[i] = cumarr[i - <span class="number">1</span>] + <span class="keyword">array</span>[i];</div><div class="line">    qsort(cumtemp, <span class="number">0</span>, <span class="built_in">size</span> - <span class="number">1</span>);</div><div class="line">    <span class="keyword">int</span> leftVal, rightVal;</div><div class="line">    findMinIndex(cumtemp, <span class="built_in">size</span>, t, leftVal, rightVal);</div><div class="line">    <span class="keyword">int</span>  leftIndex = findIndex(cumarr, <span class="built_in">size</span>, leftVal, false),</div><div class="line">        rightIndex = findIndex(cumarr, <span class="built_in">size</span>, rightVal, true);</div><div class="line"></div><div class="line">    <span class="keyword">delete</span> []cumarr;</div><div class="line">    <span class="keyword">delete</span> []cumtemp;</div><div class="line">    printf(<span class="string">"left:%d\n"</span>, leftIndex); <span class="comment">//5</span></div><div class="line">    printf(<span class="string">"right:%d\n"</span>, rightIndex); <span class="comment">//7</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> main()</div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> <span class="keyword">array</span>[] = &#123;<span class="number">31</span>, <span class="number">-41</span>, <span class="number">59</span>, <span class="number">26</span>, <span class="number">-53</span>, <span class="number">58</span>, <span class="number">97</span>, <span class="number">-93</span>, <span class="number">-23</span>, <span class="number">84</span>&#125;;</div><div class="line">    <span class="keyword">int</span> <span class="built_in">size</span> = <span class="keyword">sizeof</span>(<span class="keyword">array</span>) / <span class="keyword">sizeof</span>(<span class="keyword">int</span>);</div><div class="line">    findMostNear(<span class="keyword">array</span>, <span class="built_in">size</span>, <span class="number">4</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>2018-03-15更新<br>上面该算法是错误的，该算法仅对于t==0有效。<br>虽然cumsum是递增的，但是并不能保证相邻两项的差和t最接近。比如有cumsum<br>3 7 25 78<br>而此时t为22，显然应当[0..2]为最接近的差值（和22相差为0）。<br>目前并没有想到更好的算法，除了i，j两层循环，导致n * n的时间</p>
<h1 id="第九章"><a href="#第九章" class="headerlink" title="第九章"></a>第九章</h1><h2 id="顺序搜索"><a href="#顺序搜索" class="headerlink" title="顺序搜索"></a>顺序搜索</h2><p>在未排序的数组中搜索数值t的索引</p>
<p>书中给出了设置哨兵的算法<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;chrono&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 10000</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find_normal</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> t)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(arr[i] == t)</div><div class="line">            <span class="keyword">return</span> i;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find_with_guard</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> t)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="comment">//设置哨兵</span></div><div class="line">    arr[N] = t;</div><div class="line">    <span class="keyword">int</span> i;</div><div class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;; ++i)</div><div class="line">        <span class="keyword">if</span>(arr[i] == t)</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">if</span>(i == N)</div><div class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">    <span class="keyword">return</span> i;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="comment">//这里留一个位置给哨兵</span></div><div class="line">    <span class="keyword">int</span> arr[N + <span class="number">1</span>];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</div><div class="line">        arr[i] = i;</div><div class="line">    <span class="keyword">int</span> index;</div><div class="line">    <span class="keyword">auto</span> start = <span class="built_in">std</span>::chrono::system_clock::now();</div><div class="line">    index = find_normal(arr, N / <span class="number">2</span>);</div><div class="line">    <span class="keyword">auto</span> end   = <span class="built_in">std</span>::chrono::system_clock::now();</div><div class="line">    <span class="keyword">auto</span> duration = <span class="built_in">std</span>::chrono::duration_cast&lt;<span class="built_in">std</span>::chrono::microseconds&gt;(end - start);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"find normal, result:%d elapse time :%d microseconds\n"</span>,</div><div class="line">            index, duration.count());</div><div class="line"></div><div class="line">    start = <span class="built_in">std</span>::chrono::system_clock::now();</div><div class="line">    index = find_with_guard(arr, N / <span class="number">2</span>);</div><div class="line">    end   = <span class="built_in">std</span>::chrono::system_clock::now();</div><div class="line">    duration = <span class="built_in">std</span>::chrono::duration_cast&lt;<span class="built_in">std</span>::chrono::microseconds&gt;(end - start);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"find with guard, result:%d elapse time :%d microseconds\n"</span>,</div><div class="line">            index, duration.count());</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>但是很奇怪，我本地，使用哨兵时算法并没有变快，尝试过t为10、N/2、N-1，下面是t为N/2的输出<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">find <span class="keyword">normal</span>, <span class="built_in">result</span>:<span class="number">5000</span> elapse <span class="built_in">time</span> :<span class="number">19</span> microseconds</div><div class="line">find <span class="keyword">with</span> guard, <span class="built_in">result</span>:<span class="number">5000</span> elapse <span class="built_in">time</span> :<span class="number">18</span> microseconds</div></pre></td></tr></table></figure></p>
<p>不知道原因</p>
<h2 id="变形二分搜索：查找数字t在数组中第一次出现的位置"><a href="#变形二分搜索：查找数字t在数组中第一次出现的位置" class="headerlink" title="变形二分搜索：查找数字t在数组中第一次出现的位置"></a>变形二分搜索：查找数字t在数组中第一次出现的位置</h2><p>注意到标准的二分搜索，可能返回任意一个数字t的索引，不一定是第一个</p>
<h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><ul>
<li>我最初始的想法</li>
</ul>
<p>还是利用标准的二分搜索，但是搜索到索引之后，一直前递减，直到找到第一个和t</p>
<p>相等的索引。因为数组是排序的，所以理论上应该没问题。可能效率较差。</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> findfirst(<span class="keyword">int</span> arr[], <span class="keyword">int</span> x, <span class="keyword">int</span> <span class="built_in">size</span>)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> l = <span class="number">0</span>, u = <span class="built_in">size</span> - <span class="number">1</span>;</div><div class="line">    <span class="built_in">while</span>(l &lt;= u)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> m = (l + u) &gt;&gt; <span class="number">1</span>;</div><div class="line">        <span class="built_in">if</span>(arr[m] == x)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">while</span>(arr[--m] == x);</div><div class="line">            <span class="built_in">return</span> ++m;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">else</span> <span class="built_in">if</span>(arr[m] &gt; x)</div><div class="line">            u = m - <span class="number">1</span>;</div><div class="line">        <span class="built_in">else</span></div><div class="line">            l = m + <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">return</span> <span class="number">-1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>标准答案1<br>伪代码<figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="attr">l</span> = -<span class="number">1</span>; <span class="attr">u</span> = n</div><div class="line">while l + <span class="number">1</span> != u</div><div class="line">    <span class="comment">/*invariant: x[l] &lt; t &amp;&amp; x[u] &gt;= t &amp;&amp; l &lt; u*/</span></div><div class="line">    <span class="attr">m</span> = (l + u) / <span class="number">2</span></div><div class="line">    <span class="keyword">if</span> x[m] &lt; t</div><div class="line">        <span class="attr">l</span> = m</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="attr">u</span> = m</div><div class="line"><span class="comment">/* assert l + 1 = u &amp;&amp; x[l] &lt; t &amp;&amp; x[u] &gt;= t*/</span></div><div class="line"><span class="attr">p</span> = u</div><div class="line"><span class="keyword">if</span> p &gt;= n || x[p] != t</div><div class="line">    <span class="attr">p</span> = -<span class="number">1</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>理解一下标答</p>
<ul>
<li>初始l和u为数组边界外的两个值</li>
<li>循环直到l比u小1<br>– l和u的中间值比t小，则下界设为中间值<br>– 否则（不小于t），则上界设为中间值</li>
<li>如此循环结束后，得到条件l + 1 = u，且x[l] &lt; t，且x[u] &gt;= t。则存在几种情况<br>– 1、上限u超过返回不合法，即u = n, l = n - 1;此时未找到，返回-1<br>– 2、上限u合法，则x[u] &gt;= t,若x[u]&gt;t则也未找到，返回-1；若x[u] = t,则有x[l]&lt; t，可得u是第一个等于t的位置</li>
</ul>
<p>实现<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> findfirst_standard1(<span class="keyword">int</span> arr[], <span class="keyword">int</span> t, <span class="keyword">int</span> <span class="built_in">size</span>)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> l = <span class="number">-1</span>, u = <span class="built_in">size</span>;</div><div class="line">    <span class="built_in">while</span>(l + <span class="number">1</span> != u)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> m = (l + u) &gt;&gt; <span class="number">1</span>;</div><div class="line">        <span class="built_in">if</span>(arr[m] &lt; t)</div><div class="line">            l = m;</div><div class="line">        <span class="built_in">else</span></div><div class="line">            u = m;     </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> p = u;</div><div class="line">    <span class="built_in">if</span>(p &gt;= <span class="built_in">size</span> || arr[p] != t)</div><div class="line">        p = <span class="number">-1</span>;</div><div class="line">    <span class="built_in">return</span> p;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>标准答案2<br>伪代码<figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="attr">i</span> = <span class="number">512</span></div><div class="line"><span class="attr">l</span> = -<span class="number">1</span></div><div class="line"><span class="keyword">if</span> x[<span class="number">511</span>] &lt; t</div><div class="line">    <span class="attr">l</span> = <span class="number">1000</span> - <span class="number">512</span></div><div class="line">while i != <span class="number">1</span></div><div class="line">    <span class="comment">/* invariant: x[l] &lt; t &amp;&amp; x[l + i] &gt;= t &amp;&amp; i = 2^j*/</span></div><div class="line">    <span class="attr">nexti</span> = i / <span class="number">2</span></div><div class="line">    <span class="keyword">if</span> x[l + nexti] &lt; t</div><div class="line">        <span class="attr">l</span> = l + nexti</div><div class="line">        <span class="attr">i</span> = nexti</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="attr">i</span> = nexti</div><div class="line"><span class="comment">/* assert i == 1 &amp;&amp; x[l] &lt; t &amp;&amp; x[l + i] &gt;= t*/</span></div><div class="line"><span class="attr">p</span> = l + <span class="number">1</span></div><div class="line"><span class="keyword">if</span> p &gt; <span class="number">1000</span> || x[p] != t</div><div class="line">    <span class="attr">p</span> = -<span class="number">1</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>需要利用到n = 1000的已知条件。不使用l..u来表示区间的上下限，而是使用</p>
<p>下限l，增量i来表示，其中l + i = u，并且i总是为2的幂</p>
<p>注意到一开始i为512（因为1024已经大于1000了），所以最开始的区间要么</p>
<p>为-1..511，要么为488..1000</p>
<p>该方案一般比较慢，只是作为引子</p>
<ul>
<li>标准答案3<br>对上面程序进行优化，删除遍历nexti</li>
</ul>
<p>伪代码<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">i = <span class="number">512</span></div><div class="line">l = <span class="number">-1</span></div><div class="line">if x[<span class="number">511</span>] &lt; t</div><div class="line">    l = <span class="number">1000</span> - <span class="number">512</span></div><div class="line">while i != <span class="number">1</span></div><div class="line">    <span class="comment">/* invariant: x[l] &lt; t &amp;&amp; x[l + i] &gt;= t &amp;&amp; i = 2^j*/</span></div><div class="line">    i = i / <span class="number">2</span></div><div class="line">    if x[l + i] &lt; t</div><div class="line">        l += i</div><div class="line"><span class="comment">/* assert i == 1 &amp;&amp; x[l] &lt; t &amp;&amp; x[l + i] &gt;= t*/</span></div><div class="line">p = l + <span class="number">1</span></div><div class="line">if p &gt; <span class="number">1000</span> || x[p] != t</div><div class="line">    p = <span class="number">-1</span></div></pre></td></tr></table></figure></p>
<p>实现<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 1000</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">findfirst_standard2</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> t)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> i = <span class="number">512</span>;</div><div class="line">    <span class="keyword">int</span> l = <span class="number">-1</span>;</div><div class="line">    <span class="keyword">if</span>(arr[i - <span class="number">1</span>] &lt; t)</div><div class="line">        l = N - i;</div><div class="line">    <span class="keyword">while</span>(i != <span class="number">1</span>)</div><div class="line">    &#123;</div><div class="line">        i = i &gt;&gt; <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>(arr[l + i] &lt; t)</div><div class="line">            l += i;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> p = l + <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span>(p &gt;= N || arr[p] != t)</div><div class="line">        p = <span class="number">-1</span>;</div><div class="line">    <span class="keyword">return</span> p;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>注意倒数第三行我这里写成[ p &gt;= N ]而不是[ p &gt; N ]，理由如下：</p>
<p>比如原arr为0..999，而待查找值为1000，此时进过循环结束之后，l的值为488+256+..+2+1=999</p>
<p>所以p的值为1000，此时已经为非法越界所以，再去取arr[p]比较危险</p>
<p>不知道原书中的大于号是什么意思</p>
<ul>
<li>标准答案4<br>继续将while循环和除法优化掉，因为在N为1000的情况下，需要循环几次是已知的</li>
</ul>
<p>伪代码<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">l = <span class="number">-1</span></div><div class="line">if(x[<span class="number">511</span>] &lt; t) l = <span class="number">1000</span> - <span class="number">512</span></div><div class="line">    <span class="comment">/* assert x[l] &lt; t &amp;&amp; x[l + 512] &gt;= t*/</span></div><div class="line">if(x[l + <span class="number">256</span>] &lt; t) l += <span class="number">235</span></div><div class="line">    <span class="comment">/* assert x[l] &lt; t &amp;&amp; x[l + 256] &gt;= t*/</span></div><div class="line">if(x[l + <span class="number">128</span>] &lt; t) l += <span class="number">128</span></div><div class="line">...</div><div class="line">if(x[l + <span class="number">2</span>] &lt; t) l += <span class="number">2</span></div><div class="line">if(x[l + <span class="number">1</span>] &lt; t) l += <span class="number">1</span></div><div class="line">    <span class="comment">/* assert x[l] &lt; t &amp;&amp; x[l + 1] &gt;= t*/</span></div><div class="line">p = l + <span class="number">1</span></div><div class="line">if p &gt; <span class="number">1000</span> || x[p] != t</div><div class="line">    p = <span class="number">-1</span></div></pre></td></tr></table></figure></p>
<p>没有什么好说的，牺牲了简洁性而为了调优吧</p>
<h2 id="宏和函数求最值性能比较"><a href="#宏和函数求最值性能比较" class="headerlink" title="宏和函数求最值性能比较"></a>宏和函数求最值性能比较</h2><figure class="highlight zephir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">float</span> max(<span class="keyword">float</span> a, <span class="keyword">float</span> b)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">return</span> a &gt; b ? a : b;</div><div class="line">&#125;</div><div class="line"><span class="comment">//返回数组0..n-1中的最大值，其中n最大为size</span></div><div class="line"><span class="keyword">float</span> arrmax(<span class="keyword">float</span> arr[], <span class="keyword">int</span> size, <span class="keyword">int</span> n)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(n == <span class="number">1</span>)</div><div class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">    <span class="keyword">return</span> max(arr[n - <span class="number">1</span>], arrmax(arr, size, n - <span class="number">1</span>));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">#define max_macro(a, b) ((a) &gt; (b) ? (a) : (b))</span></div><div class="line"><span class="keyword">float</span> arrmax_macro(<span class="keyword">float</span> arr[], <span class="keyword">int</span> size, <span class="keyword">int</span> n)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(n == <span class="number">1</span>)</div><div class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">    <span class="keyword">return</span> max_macro(arr[n - <span class="number">1</span>], arrmax_macro(arr, size, n - <span class="number">1</span>));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> main()</div><div class="line">&#123;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">int</span> size = <span class="number">28</span>;</div><div class="line">    <span class="keyword">float</span> arr[size];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; ++i)</div><div class="line">        arr[i] = (size - i) * <span class="number">1.0</span>;</div><div class="line">    auto start = std::chrono::system_clock::now();</div><div class="line">    printf(<span class="string">"max:%f\n"</span>, arrmax(arr, size, <span class="number">28</span>));</div><div class="line">    auto end   = std::chrono::system_clock::now();</div><div class="line">    auto duration = std::chrono::duration_cast&lt;std::chrono::microseconds&gt;(end - start);</div><div class="line">    printf(<span class="string">"func max elapse time :%d microseconds\n"</span>, duration.count());</div><div class="line"></div><div class="line">    start = std::chrono::system_clock::now();</div><div class="line">    printf(<span class="string">"max:%f\n"</span>, arrmax_macro(arr, size, <span class="number">28</span>));</div><div class="line">    end   = std::chrono::system_clock::now();</div><div class="line">    duration = std::chrono::duration_cast&lt;std::chrono::microseconds&gt;(end - start);</div><div class="line">    printf(<span class="string">"macro max elapse time :%d microseconds\n"</span>, duration.count());</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>输出<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">max:</span><span class="number">27.000000</span></div><div class="line">func max elapse time :<span class="number">138</span> microseconds</div><div class="line"><span class="symbol">max:</span><span class="number">27.000000</span></div><div class="line"><span class="function"><span class="keyword">macro</span> <span class="title">max</span></span> elapse time :<span class="number">1341535</span> microseconds</div></pre></td></tr></table></figure></p>
<p>真是说明宏在某些情况下性能不好的极致例子了。</p>
<p>书中说“一组按降序排列的值可以使算法的时间开销约为2<sup>n</sup>”。</p>
<p>这个没理解</p>
<h2 id="习题7-求解数的二进制中1的个数"><a href="#习题7-求解数的二进制中1的个数" class="headerlink" title="习题7-求解数的二进制中1的个数"></a>习题7-求解数的二进制中1的个数</h2><p>参考<a href="../../../../2017/12/24/C++常用知识点/#求解整数二进制数中1的个数">求解整数二进制数中1的个数</a></p>
<h2 id="习题8-查找数组元素的最大值"><a href="#习题8-查找数组元素的最大值" class="headerlink" title="习题8-查找数组元素的最大值"></a>习题8-查找数组元素的最大值</h2><p>分别使用普通方法，和哨兵方法比较了一下</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line">#define <span class="built_in">N</span> <span class="number">10000</span></div><div class="line"></div><div class="line"><span class="built_in">int</span> findMax_normal(<span class="built_in">int</span> arr[])</div><div class="line">&#123;</div><div class="line">    printf(<span class="string">"%d\n"</span>, <span class="built_in">N</span>);</div><div class="line">    <span class="built_in">int</span> <span class="built_in">max</span> = arr[<span class="number">0</span>], maxIndex = <span class="number">0</span>;</div><div class="line">    for(<span class="built_in">int</span> i = <span class="number">1</span>; i &lt; <span class="built_in">N</span>; ++i)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">if</span>(arr[i] &gt; <span class="built_in">max</span>)</div><div class="line">        &#123;</div><div class="line">            maxIndex = i;</div><div class="line">            <span class="built_in">max</span> = arr[i];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return <span class="built_in">max</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">int</span> findMax_guard(<span class="built_in">int</span> arr[])</div><div class="line">&#123;</div><div class="line">    <span class="built_in">int</span> <span class="built_in">index</span> = <span class="number">0</span>;</div><div class="line">    <span class="built_in">int</span> <span class="built_in">max</span>;</div><div class="line">    while(<span class="built_in">index</span> &lt; <span class="built_in">N</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">max</span> = arr[<span class="built_in">index</span>];</div><div class="line">        arr[<span class="built_in">N</span>] = <span class="built_in">max</span>;</div><div class="line">        <span class="built_in">index</span>++;</div><div class="line">        while(arr[<span class="built_in">index</span>] &lt; <span class="built_in">max</span>)</div><div class="line">            <span class="built_in">index</span>++;</div><div class="line">    &#125;</div><div class="line">    return arr[<span class="built_in">N</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">int</span> main()</div><div class="line">&#123;</div><div class="line">    <span class="built_in">int</span> arr[<span class="built_in">N</span> + <span class="number">1</span>];</div><div class="line">    for(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">N</span> / <span class="number">2</span>; ++i)</div><div class="line">        arr[i] = i;</div><div class="line">    for(<span class="built_in">int</span> i = <span class="built_in">N</span> / <span class="number">2</span>; i &lt; <span class="built_in">N</span>; ++i)</div><div class="line">        arr[i] = <span class="built_in">N</span> - i;</div><div class="line">    <span class="built_in">int</span> <span class="built_in">max</span>;</div><div class="line">    auto start = s<span class="symbol">td:</span><span class="symbol">:ch</span>ro<span class="symbol">no:</span><span class="symbol">:sy</span>stem_clo<span class="symbol">ck:</span><span class="symbol">:no</span>w();</div><div class="line">    <span class="built_in">max</span> = findMax_normal(arr);</div><div class="line">    auto end   = s<span class="symbol">td:</span><span class="symbol">:ch</span>ro<span class="symbol">no:</span><span class="symbol">:sy</span>stem_clo<span class="symbol">ck:</span><span class="symbol">:no</span>w();</div><div class="line">    auto <span class="built_in">duration</span> = s<span class="symbol">td:</span><span class="symbol">:ch</span>ro<span class="symbol">no:</span><span class="symbol">:du</span>ration_cast&lt;s<span class="symbol">td:</span><span class="symbol">:ch</span>ro<span class="symbol">no:</span><span class="symbol">:mi</span>croseconds&gt;(end - start);</div><div class="line">    printf(<span class="string">"findMax normal, result:%d elapse time :%ld microseconds\n"</span>, </div><div class="line">            <span class="built_in">max</span>, duration.count());</div><div class="line"></div><div class="line">    start = s<span class="symbol">td:</span><span class="symbol">:ch</span>ro<span class="symbol">no:</span><span class="symbol">:sy</span>stem_clo<span class="symbol">ck:</span><span class="symbol">:no</span>w();</div><div class="line">    <span class="built_in">max</span> = findMax_guard(arr);</div><div class="line">    end   = s<span class="symbol">td:</span><span class="symbol">:ch</span>ro<span class="symbol">no:</span><span class="symbol">:sy</span>stem_clo<span class="symbol">ck:</span><span class="symbol">:no</span>w();</div><div class="line">    <span class="built_in">duration</span> = s<span class="symbol">td:</span><span class="symbol">:ch</span>ro<span class="symbol">no:</span><span class="symbol">:du</span>ration_cast&lt;s<span class="symbol">td:</span><span class="symbol">:ch</span>ro<span class="symbol">no:</span><span class="symbol">:mi</span>croseconds&gt;(end - start);</div><div class="line">    printf(<span class="string">"findMax guard, result:%d elapse time :%ld microseconds\n"</span>,</div><div class="line">            <span class="built_in">max</span>, duration.count());</div><div class="line">    </div><div class="line">    return <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>输出如下<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">findMax <span class="keyword">normal</span>, <span class="built_in">result</span>:<span class="number">5000</span> elapse <span class="built_in">time</span> :<span class="number">171</span> microseconds</div><div class="line">findMax guard, <span class="built_in">result</span>:<span class="number">5000</span> elapse <span class="built_in">time</span> :<span class="number">40</span> microseconds</div></pre></td></tr></table></figure></p>
<p>可以看出使用哨兵方法，优化的还是比较大的</p>
<h2 id="习题12"><a href="#习题12" class="headerlink" title="习题12"></a>习题12</h2><p>有时会从数学的角度，而不是代码的角度考虑优化，比如为了计算下面多项式</p>
<p>y = a<sub>n</sub>x<sup>n</sup> + a<sub>n-1</sub>x<sup>n-1</sup> + ..+a<sub>1</sub>x<sup>1</sup> + a<sub>0</sub><br><figure class="highlight zephir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#define N 25</span></div><div class="line"></div><div class="line"><span class="keyword">long</span> y_bad(<span class="keyword">int</span> a[], <span class="keyword">int</span> x)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">long</span> y = a[<span class="number">0</span>];</div><div class="line">    <span class="keyword">int</span> xi = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</div><div class="line">    &#123;</div><div class="line">        xi *= x;</div><div class="line">        y += a[i]*xi;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> y;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">long</span> y_good(<span class="keyword">int</span> a[], <span class="keyword">int</span> x)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">long</span> y = a[N];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</div><div class="line">    &#123;</div><div class="line">        y = y * x + a[i];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> y;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> main()</div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> a[N + <span class="number">1</span>];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; ++i)</div><div class="line">        a[i] = i;</div><div class="line">    <span class="keyword">long</span> y;</div><div class="line">    auto start = std::chrono::system_clock::now();</div><div class="line">    y = y_bad(a, <span class="number">2</span>);</div><div class="line">    auto end   = std::chrono::system_clock::now();</div><div class="line">    auto duration = std::chrono::duration_cast&lt;std::chrono::microseconds&gt;(end - start);</div><div class="line">    printf(<span class="string">"y_bad, result:%ld elapse time :%ld microseconds\n"</span>, </div><div class="line">            y, duration.count());</div><div class="line"></div><div class="line">    start = std::chrono::system_clock::now();</div><div class="line">    y = y_good(a, <span class="number">2</span>);</div><div class="line">    end   = std::chrono::system_clock::now();</div><div class="line">    duration = std::chrono::duration_cast&lt;std::chrono::microseconds&gt;(end - start);</div><div class="line">    printf(<span class="string">"y_good, result:%ld elapse time :%ld microseconds\n"</span>, </div><div class="line">            y, duration.count());</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>很遗憾，实际两者都很快，输出<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">y_bad, <span class="literal">result</span>:<span class="number">1610612738</span> elapse <span class="built_in">time</span> :<span class="number">0</span> microseconds</div><div class="line">y_good, <span class="literal">result</span>:<span class="number">1610612738</span> elapse <span class="built_in">time</span> :<span class="number">0</span> microseconds</div></pre></td></tr></table></figure></p>
<h1 id="第10章"><a href="#第10章" class="headerlink" title="第10章"></a>第10章</h1><h2 id="10-2示例问题"><a href="#10-2示例问题" class="headerlink" title="10.2示例问题"></a>10.2示例问题</h2><h3 id="描述-5"><a href="#描述-5" class="headerlink" title="描述"></a>描述</h3><p>在地理数据库中存储2000个邻居，编号0..1999，输入x,y（范围都是0..199）</p>
<p>需要确定用户选中了2000个点中的哪个。</p>
<p>书中介绍三种实现</p>
<ul>
<li>直接二维数组</li>
<li>列数组加链表的稀疏矩阵</li>
<li>列数组加并行数组的稀疏矩阵</li>
</ul>
<h3 id="实现-4"><a href="#实现-4" class="headerlink" title="实现"></a>实现</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 200</span></div><div class="line"></div><div class="line"><span class="comment">//以下func(x, y)表示取第x列，y行数据</span></div><div class="line"><span class="comment">//方法一：直接存储成二维数组，优点是简单，缺点是对于稀疏矩阵，存在巨大空间浪费</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">storeAsNormalArray</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></div><div class="line">&#123;</div><div class="line">    assert(x &lt; N &amp;&amp; y &lt; N);</div><div class="line">    <span class="keyword">int</span> <span class="built_in">array</span>[N][N] = &#123;<span class="number">-1</span>&#125;;</div><div class="line">    <span class="comment">//input</span></div><div class="line">    <span class="built_in">array</span>[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">17</span>;</div><div class="line">    <span class="built_in">array</span>[<span class="number">0</span>][<span class="number">5</span>] = <span class="number">538</span>;</div><div class="line">    <span class="built_in">array</span>[<span class="number">3</span>][<span class="number">4</span>] = <span class="number">965</span>;</div><div class="line">    <span class="built_in">array</span>[<span class="number">5</span>][<span class="number">3</span>] = <span class="number">1171</span>;</div><div class="line">    <span class="built_in">array</span>[<span class="number">7</span>][<span class="number">1</span>] = <span class="number">162</span>;</div><div class="line">    <span class="comment">//output</span></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, <span class="built_in">array</span>[x][y]);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//方法二：利用链表</span></div><div class="line"><span class="comment">//使用数组表示所有的列，并使用链表来表示给定列中的活跃元素</span></div><div class="line"><span class="comment">//表面上记录数据的节点少了，但实际上由于节点指针，malloc/new的消耗，可能导致空间增大</span></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> data_;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> row_;</div><div class="line">    Node *next_;</div><div class="line">    Node(<span class="keyword">unsigned</span> <span class="keyword">char</span> row, <span class="keyword">int</span> d = <span class="number">0</span>)</div><div class="line">        : row_(row), data_(d), next_(<span class="literal">nullptr</span>) &#123;&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">addData</span><span class="params">(Node *&amp;colhead, <span class="keyword">unsigned</span> <span class="keyword">char</span> row, <span class="keyword">int</span> data)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(colhead == <span class="literal">nullptr</span>)</div><div class="line">        colhead = <span class="keyword">new</span> Node(<span class="number">0</span>, <span class="number">0</span>);</div><div class="line">    Node *p = colhead;</div><div class="line">    <span class="keyword">while</span>(p-&gt;next_)</div><div class="line">        p = p-&gt;next_;</div><div class="line">    p-&gt;next_ = <span class="keyword">new</span> Node(row, data);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">storeWithList</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></div><div class="line">&#123;</div><div class="line">    assert(x &lt; N &amp;&amp; y &lt; N);</div><div class="line">    Node *colhead[N] = &#123;<span class="literal">nullptr</span>&#125;;</div><div class="line">    <span class="comment">//input</span></div><div class="line">    addData(colhead[<span class="number">0</span>], <span class="number">2</span>, <span class="number">17</span>);</div><div class="line">    addData(colhead[<span class="number">0</span>], <span class="number">5</span>, <span class="number">538</span>);</div><div class="line">    addData(colhead[<span class="number">3</span>], <span class="number">4</span>, <span class="number">965</span>);</div><div class="line">    addData(colhead[<span class="number">5</span>], <span class="number">3</span>, <span class="number">1171</span>);</div><div class="line">    addData(colhead[<span class="number">7</span>], <span class="number">1</span>, <span class="number">62</span>);</div><div class="line">    <span class="comment">//output</span></div><div class="line">    <span class="keyword">for</span>(Node *p = colhead[x]; p != <span class="literal">nullptr</span>; p = p-&gt;next_)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(p-&gt;row_ == y)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, p-&gt;data_);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;   </div><div class="line">    <span class="comment">//release</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</div><div class="line">    &#123;</div><div class="line">        Node *head = colhead[i];</div><div class="line">        <span class="keyword">if</span>(head == <span class="literal">nullptr</span>)</div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        Node *p = head, *q;</div><div class="line">        <span class="keyword">while</span>(p)</div><div class="line">        &#123;</div><div class="line">            q = p-&gt;next_;</div><div class="line">            <span class="keyword">delete</span> p;</div><div class="line">            p = q;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//方法三：不使用指针和结构</span></div><div class="line"><span class="comment">//使用201元的数组来表示列，并用2000元的并行数组表示这些点</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> NUMSIZE 2000</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">addData</span><span class="params">(<span class="keyword">int</span> firstincol[], <span class="keyword">unsigned</span> <span class="keyword">char</span> row[],</span></span></div><div class="line">             <span class="keyword">int</span> pointnum[], <span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> data)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> curcol = firstincol[x + <span class="number">1</span>];</div><div class="line">    row[curcol] = y;</div><div class="line">    pointnum[curcol] = data;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = x + <span class="number">1</span>; i &lt;= N; ++i)</div><div class="line">        firstincol[i] += <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">storeWithColArray</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> firstincol[N + <span class="number">1</span>] = &#123;<span class="number">0</span>&#125;;</div><div class="line">    <span class="keyword">int</span> pointnum[NUMSIZE];</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> row[NUMSIZE];</div><div class="line">    <span class="comment">//input</span></div><div class="line">    addData(firstincol, row, pointnum, <span class="number">0</span>, <span class="number">2</span>, <span class="number">17</span>);</div><div class="line">    addData(firstincol, row, pointnum, <span class="number">0</span>, <span class="number">5</span>, <span class="number">17</span>);</div><div class="line">    addData(firstincol, row, pointnum, <span class="number">3</span>, <span class="number">4</span>, <span class="number">965</span>);</div><div class="line">    addData(firstincol, row, pointnum, <span class="number">5</span>, <span class="number">3</span>, <span class="number">1171</span>);</div><div class="line">    addData(firstincol, row, pointnum, <span class="number">7</span>, <span class="number">1</span>, <span class="number">162</span>);</div><div class="line">    <span class="comment">//output</span></div><div class="line">    <span class="comment">//第i列的点由数组row和pointnum中位于firstincol[i]和firstincol[i+1]-1</span></div><div class="line">    <span class="comment">//之间的元素表示</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = firstincol[x]; k &lt; firstincol[x + <span class="number">1</span>]; ++k)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(row[k] == y)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, pointnum[k]);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    storeAsNormalArray(<span class="number">5</span>, <span class="number">3</span>);</div><div class="line">    storeWithList(<span class="number">5</span>, <span class="number">3</span>);</div><div class="line">    storeWithColArray(<span class="number">5</span>, <span class="number">3</span>);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="两个对称矩阵的压缩"><a href="#两个对称矩阵的压缩" class="headerlink" title="两个对称矩阵的压缩"></a>两个对称矩阵的压缩</h2><h3 id="描述-6"><a href="#描述-6" class="headerlink" title="描述"></a>描述</h3><p>Brian Kernighan编写了一个旅行商程序，给出如下共享存储空间方法。</p>
<p>有150×150的矩阵（分别为a,b），都是用来表示点与点之间的距离，从而知道他们有如下特点</p>
<ul>
<li>对角线为0值，即a[i, i] = 0</li>
<li>矩阵是对称的，即a[i, j] = a[j, i]</li>
</ul>
<p>使用如下方阵c来共享</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="number">0</span>        b[<span class="number">0</span>, <span class="number">1</span>]    b[<span class="number">0</span>, <span class="number">2</span>]</div><div class="line"></div><div class="line">a[<span class="number">0</span>, <span class="number">1</span>]  <span class="number">0</span>          b[<span class="number">1</span>, <span class="number">2</span>]</div><div class="line"></div><div class="line">a[<span class="number">2</span>, <span class="number">0</span>]  a[<span class="number">2</span>, <span class="number">1</span>]    <span class="number">0</span></div></pre></td></tr></table></figure>
<p>举例如下<br><figure class="highlight tap"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">    <span class="number"> 0 </span> <span class="number"> 1 </span> <span class="number"> 3 </span>     <span class="number"> 0 </span> <span class="number"> 4 </span> <span class="number"> 5 </span>     <span class="number"> 0 </span> <span class="number"> 4 </span>  5</div><div class="line">a:  <span class="number"> 1 </span> <span class="number"> 0 </span> <span class="number"> 2 </span>   b:<span class="number"> 4 </span> <span class="number"> 0 </span> <span class="number"> 6 </span>   c:<span class="number"> 1 </span> <span class="number"> 0 </span>  6</div><div class="line">    <span class="number"> 3 </span> <span class="number"> 2 </span> <span class="number"> 0 </span>     <span class="number"> 5 </span> <span class="number"> 6 </span> <span class="number"> 0 </span>     <span class="number"> 3 </span> <span class="number"> 2 </span>  0</div></pre></td></tr></table></figure></p>
<p>则可得</p>
<p>a[i, j] = c[max(i, j), min(i, j)]<br>b[i, j] = c[min(i, j), max(i, j)]</p>
<p>比如 a[1, 2] = c[2, 1] , b[1, 2] = c[1, 2]</p>
<h1 id="第11章-排序"><a href="#第11章-排序" class="headerlink" title="第11章-排序"></a>第11章-排序</h1><p>对比之前的文章:<a href="../../../../2017/12/30/常见排序算法C++实现">常见排序算法C++实现</a></p>
<h2 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h2><p>呵，将打牌时排列手中的牌类比成插入排序，有意思</p>
<ul>
<li><p>伪代码</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> <span class="built_in">i</span> = [<span class="number">1</span>, n)</div><div class="line">    t = x[i]</div><div class="line">    <span class="keyword">for</span> (<span class="built_in">j</span> = <span class="built_in">i</span>; <span class="built_in">j</span> &gt; <span class="number">0</span> &amp;&amp; x[j - <span class="number">1</span>] &gt; t; <span class="built_in">j</span>--)</div><div class="line">        x[j] = x[j - <span class="number">1</span>]</div><div class="line">    x[j] = t</div></pre></td></tr></table></figure>
</li>
<li><p>实现</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">void <span class="keyword">insertSort(int </span>arr[], int size)</div><div class="line">&#123;</div><div class="line">    for(int i = <span class="number">1</span><span class="comment">; i &lt; size; ++i)</span></div><div class="line">    &#123;</div><div class="line">        int curdata = arr[i]<span class="comment">;</span></div><div class="line">        int <span class="keyword">j;</span></div><div class="line">        for(<span class="keyword">j </span>= i<span class="comment">; j &gt; 0 &amp;&amp; arr[j - 1] &gt; curdata; --j)</span></div><div class="line">            arr[<span class="keyword">j] </span>= arr[<span class="keyword">j </span>- <span class="number">1</span>]<span class="comment">;</span></div><div class="line">        arr[<span class="keyword">j] </span>= curdata<span class="comment">;</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h2><ul>
<li>简单的</li>
</ul>
<p>伪代码<br><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">void qsort1(l, u)</div><div class="line">    if(l &gt;= u)</div><div class="line">        return</div><div class="line">    m = l</div><div class="line">    for i = <span class="string">[l + 1, u]</span></div><div class="line">        /* invariant: x<span class="string">[l+1..m]</span>    &lt;  x<span class="string">[l]</span> &amp;&amp;</div><div class="line">                      x<span class="string">[m+1..i-1]</span>  &gt;= x<span class="string">[l]</span>*/</div><div class="line">        if(x<span class="string">[i]</span> &lt; x<span class="string">[l]</span>)</div><div class="line">            swap(++m, i)</div><div class="line">    swap(l, m)</div><div class="line">    /* x<span class="string">[l..m-1]</span> &lt; x<span class="string">[m]</span> &lt;= x<span class="string">[m+1..u]</span>*/</div><div class="line">    qsort(l, m - <span class="number">1</span>)</div><div class="line">    qsort(m + <span class="number">1</span>, u)</div></pre></td></tr></table></figure></p>
<p>实现<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">qsort1</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> l, <span class="keyword">int</span> u)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(l &gt;= u)</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">int</span> m = l;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = l + <span class="number">1</span>; i &lt;= u; ++i)</div><div class="line">        <span class="keyword">if</span>(arr[i] &lt; arr[l])</div><div class="line">            swap(arr[++m], arr[i]);</div><div class="line">    swap(arr[m], arr[l]);</div><div class="line">    qsort1(arr, l, m - <span class="number">1</span>);</div><div class="line">    qsort1(arr, m + <span class="number">1</span>, u);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>其实和之前文章中的快排方法1是对应的。</p>
<p>对于随机输入，这种快速排序算法很快，但他也存在一个致命的问题，当输入是数组是全部相等的，<br>则需要O(n<sup>2</sup>)时间。 原因很简单，上面的for循环里，if条件一次都不满足。</p>
<ul>
<li>使用哨兵优化上面的快排<br>书中有两个提示：1、使用x[l]作为哨兵；2、移除循环后的swap</li>
</ul>
<p>看到这个说法时，我的想法<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">qsort2</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> l, <span class="keyword">int</span> u)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(l &gt;= u)</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    <span class="comment">//不同点1、记录哨兵值</span></div><div class="line">    <span class="keyword">int</span> hold = arr[l];</div><div class="line">    <span class="keyword">int</span> m = l;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = l + <span class="number">1</span>; i &lt;= u; ++i)</div><div class="line">        <span class="comment">//不同点2、待比较值不再是arr[l]，该值可能变化了</span></div><div class="line">        <span class="keyword">if</span>(arr[i] &lt; hold)</div><div class="line">            <span class="comment">//不同点3、m使用后置自增</span></div><div class="line">            swap(arr[m++], arr[i]);</div><div class="line">    <span class="comment">//不同点4、这里不再进行swap。循环退出后到了这里，m指向不比hold小的值</span></div><div class="line">    qsort2(arr, l, m - <span class="number">1</span>);</div><div class="line">    qsort2(arr, m + <span class="number">1</span>, u);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>使用{1, 2, .. ,7}、{7, 6..1}、{3, 1, 2, 4, 7, 5, 6}测试都OK，正确性待验证</p>
<p>书中标准答案如下：</p>
<p>划分方案改为从右往左伪代码<br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">m = u + <span class="number">1</span></div><div class="line"><span class="keyword">for</span>(<span class="built_in">i</span> = u; <span class="built_in">i</span> &gt;= l; <span class="built_in">i</span>--)</div><div class="line">    <span class="keyword">if</span> x[i] &gt;= t</div><div class="line">        swap(--m, <span class="built_in">i</span>)</div></pre></td></tr></table></figure></p>
<p>循环终止时，即i为l时，x[i] &gt;= t成立，所以x[m]会被置为t，这样就不再需要额外的swap啦</p>
<ul>
<li>使用x[l]作为哨兵伪代码</li>
</ul>
<p>可以省去内循环中的一次测试</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">m = i = u + <span class="number">1</span></div><div class="line"><span class="keyword">do</span></div><div class="line">    <span class="keyword">while</span> x[<span class="comment">--i] &lt; t</span></div><div class="line">        ;</div><div class="line">    swap(<span class="comment">--m, i)</span></div><div class="line"><span class="keyword">while</span> i != l</div></pre></td></tr></table></figure>
<p>实现<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">qsort2</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> l, <span class="keyword">int</span> u)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(l &gt;= u)</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">int</span> m = u + <span class="number">1</span>, i = u + <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> t = arr[l];</div><div class="line">    <span class="keyword">do</span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">while</span>(arr[--i] &lt; t);</div><div class="line">        swap(arr[--m], arr[i]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">while</span>(i != l);</div><div class="line">    qsort2(arr, l, m - <span class="number">1</span>);</div><div class="line">    qsort2(arr, m + <span class="number">1</span>, u);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>双向划分</li>
</ul>
<p>伪代码<br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">void qsort3(l, u)</div><div class="line">    <span class="keyword">if</span> l &gt;= u</div><div class="line">        <span class="keyword">return</span></div><div class="line">    t = x[l]; <span class="built_in">i</span> = l; <span class="built_in">j</span> = u + <span class="number">1</span></div><div class="line">    loop</div><div class="line">        do <span class="built_in">i</span>++ <span class="keyword">while</span> <span class="built_in">i</span> &lt;= u &amp;&amp; x[i] &lt; t</div><div class="line">        do <span class="built_in">j</span>-- <span class="keyword">while</span> x[j] &gt; t</div><div class="line">        <span class="keyword">if</span> <span class="built_in">i</span> &gt; <span class="built_in">j</span></div><div class="line">            <span class="keyword">break</span></div><div class="line">        swap(<span class="built_in">i</span>, <span class="built_in">j</span>)</div><div class="line">    swap(l, <span class="built_in">j</span>)</div><div class="line">    qsort3(l, <span class="built_in">j</span> - <span class="number">1</span>)</div><div class="line">    qsort3(<span class="built_in">j</span> + <span class="number">1</span>, u)</div></pre></td></tr></table></figure></p>
<p>真是精妙无比，几个注意点<br>– j从u + 1开始，因为do..while，先做j–<br>– x[i],x[j]与t比较时都是绝对的大于小于。如果用了&gt;=或&lt;=会怎么样？<br>   如果数组值全部相等<br>   1、将x[i] &lt; t改成x[i] &lt;= t，第一个do..while之后i等于u+1，第二个do..while第一次<br>   就不满足，所以j等于u，走break，走qsort3(l, u-1)，这样整个复杂的为O(n<sup>2</sup>)<br>   2、将x[j] &lt; t改成x[j] &lt;= t，第二个do..while不能正确地退出，原因参考下一条说明<br>– 为什么第二个do..while，不需要j &gt;= l这样的判断？因为x[l] == t，所以x[l]<br>   充当了哨兵的作用，无论如何，程序最差也会在j == l的时候退出，不会导致死循环</p>
<p>这么来看的话，前一篇文章中的快排都没有很好地考虑元素全相等的情况</p>
<ul>
<li>结合插入排序再优化<figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">void qsort4(l, u)</div><div class="line">    <span class="keyword">if</span> u - l &lt; cutoff</div><div class="line">        <span class="keyword">return</span></div><div class="line">    swap(l, randint(l, u))</div><div class="line">    <span class="built_in">i</span> = l, <span class="built_in">j</span> = u + <span class="number">1</span>, t = x[l]</div><div class="line">    loop</div><div class="line">        do <span class="built_in">i</span>++ <span class="keyword">while</span> <span class="built_in">i</span> &lt;= u &amp;&amp; x[i] &lt; t</div><div class="line">        do <span class="built_in">j</span>-- <span class="keyword">while</span> x[j] &gt; t</div><div class="line">        <span class="keyword">if</span> <span class="built_in">i</span> &gt; <span class="built_in">j</span></div><div class="line">            <span class="keyword">break</span></div><div class="line">        temp = x[i]; x[i] = x[j]; x[j] = t</div><div class="line">    swap(l, <span class="built_in">j</span>)</div><div class="line">    qsort4(l, <span class="built_in">j</span> - <span class="number">1</span>)</div><div class="line">    qsort4(<span class="built_in">j</span> + <span class="number">1</span>, u)</div></pre></td></tr></table></figure>
</li>
</ul>
<p>然后程序结束之后再调用插入排序<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">qsort4</span><span class="params">(<span class="number">0</span>, n - <span class="number">1</span>)</span></span></div><div class="line"><span class="function"><span class="title">isort</span><span class="params">()</span></span></div></pre></td></tr></table></figure></p>
<p>参考书中习题，cutoff取50是个比较合理的值</p>
<h1 id="第12章"><a href="#第12章" class="headerlink" title="第12章"></a>第12章</h1><h2 id="两个常用函数"><a href="#两个常用函数" class="headerlink" title="两个常用函数"></a>两个常用函数</h2><ul>
<li><p>bigrand()<br>C库函数rand()通常返回15个随机位（最大值RAND_MAX 为32767），要求返回30个随机位</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> bigrand()</div><div class="line">&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">rand</span>() * RAND_MAX + <span class="keyword">rand</span>();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>randint(l, u)<br>返回l和u之间的随机值（包括l和u）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">randint</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> u)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">return</span> l + bigrand() % (u - l + <span class="number">1</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="题目1：输出随机有序列表"><a href="#题目1：输出随机有序列表" class="headerlink" title="题目1：输出随机有序列表"></a>题目1：输出随机有序列表</h2><p>输入两个整数m和n，其中m &lt; n。输出是0~n-1范围内m个随机整数的有序列表，不允许重复</p>
<ul>
<li>方案一</li>
</ul>
<p>依次考虑整数0,1,2,…,n-1，并通过适当的随机测试对每个整数进行选择；<br>通过按序进行</p>
<p>– 伪代码<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">select</span> = m</div><div class="line">remaining = n</div><div class="line"><span class="keyword">for</span> i = [<span class="number">0</span>, n)</div><div class="line">    <span class="keyword">if</span> (bigrand() % remaining) &lt; <span class="built_in">select</span></div><div class="line">        <span class="built_in">print</span> i</div><div class="line">        <span class="built_in">select</span><span class="comment">--</span></div><div class="line">    remaining<span class="comment">--</span></div></pre></td></tr></table></figure></p>
<p>只要m&lt;=n，程序输出的整数就恰好为m个，因为<br>1、不会选择更多的整数，因为select变为0时，if条件就永远为false了<br>2、不会选择更好的数，因为当remaining == select时，if条件为true</p>
<p>– 实现<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">randseries1</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n)</span></span></div><div class="line">&#123;</div><div class="line">    assert(m &lt;= n);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>((bigrand() % (n - i)) &lt; m)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d "</span>, i);</div><div class="line">            --m;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>– 存在问题<br>很明显程序运行时间正比于n，当n很大，m很小时，存在较大浪费</p>
<ul>
<li>方案二<br>在初始为空的集合里插入随机整数，直到个数足够</li>
</ul>
<p>– 伪代码<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">initialize <span class="keyword">set</span> S <span class="keyword">to</span> <span class="keyword">empty</span></div><div class="line"><span class="keyword">size</span> = <span class="number">0</span></div><div class="line"><span class="keyword">while</span> <span class="keyword">size</span> &lt; m <span class="keyword">do</span></div><div class="line">    t = bigrand() % n</div><div class="line">    <span class="keyword">if</span> t <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">in</span> S</div><div class="line">        <span class="keyword">insert</span> t <span class="keyword">into</span> S</div><div class="line">        <span class="keyword">size</span>++</div><div class="line">print the elements <span class="keyword">of</span> S <span class="keyword">in</span> sorted <span class="keyword">order</span></div></pre></td></tr></table></figure></p>
<p>C++ stl里的set正好符合当前的需求。set有两个特点：1、不存在重复元素2、元素自动排序</p>
<p>– 实现<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">randseries2</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n)</span></span></div><div class="line">&#123;</div><div class="line">    assert(m &lt;= n);</div><div class="line">    <span class="built_in">std</span>::<span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; s;</div><div class="line">    <span class="keyword">while</span>(s.size() != m)</div><div class="line">    &#123;</div><div class="line">        s.insert(bigrand() % n);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> i : s)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, i);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>– 存在问题<br>空间开销比较大。需要将全部m个数存储在一个set中，当m较大时，需要很多额外空间</p>
<ul>
<li>方案三<br>把包含0~n-1个整数的数组顺序打乱，把前m个元素排序输出</li>
</ul>
<p>– 实现<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">randseries3</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n)</span></span></div><div class="line">&#123;</div><div class="line">    assert(m &lt;= n);</div><div class="line">    <span class="keyword">int</span> i, j;</div><div class="line">    <span class="keyword">int</span> *x = <span class="keyword">new</span> <span class="keyword">int</span>[n];</div><div class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; ++i)</div><div class="line">        x[i] = i;</div><div class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; m; ++i)</div><div class="line">    &#123;</div><div class="line">        j = randint(i, n - <span class="number">1</span>);</div><div class="line">        <span class="keyword">int</span> t = x[i]; x[i] = x[j]; x[j] = t;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">std</span>::sort(x, x + m);</div><div class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; m; ++i)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, x[i]);</div><div class="line">    <span class="keyword">delete</span> []x;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>还是比较好理解的</p>
<ol>
<li>建立长度为n的临时数组，并赋值为0~n-1</li>
<li>i从0到m-1循环，并从i到n-1之间随机出一个索引。将该索引与i对应的值交换</li>
<li>此时0~m-1之间的值是乱序的随机值，排序之后输出</li>
</ol>
<p>但是性能通常不如方案一</p>
<h2 id="习题"><a href="#习题" class="headerlink" title="习题"></a>习题</h2><ul>
<li>题目7<br>递归方式输出顺序随机整数</li>
</ul>
<p>伪代码<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">void randselect(<span class="keyword">m</span>, <span class="keyword">n</span>)</div><div class="line">    pre 0 &lt;= <span class="keyword">m</span> &lt;= <span class="keyword">n</span></div><div class="line">    <span class="keyword">post</span> <span class="keyword">m</span> <span class="keyword">distinct</span> integers from 0..<span class="keyword">n</span>-1 are</div><div class="line">         printed <span class="keyword">in</span> decreasing <span class="keyword">order</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">m</span> &gt; 0</div><div class="line">        <span class="keyword">if</span> (bigrand() % <span class="keyword">n</span>) &lt; <span class="built_in">m</span></div><div class="line">            <span class="keyword">print</span> <span class="keyword">n</span> - 1</div><div class="line">            randselect(<span class="keyword">m</span> - 1, <span class="keyword">n</span> - 1)</div><div class="line">        <span class="keyword">else</span></div><div class="line">            randselect(<span class="keyword">m</span>, <span class="keyword">n</span> - 1)</div></pre></td></tr></table></figure></p>
<p>按照伪代码实现<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">randselect1</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(m &lt;= <span class="number">0</span> || m &gt; n)</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">if</span>(bigrand() % n &lt; m)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, n - <span class="number">1</span>);</div><div class="line">        randselect1(m - <span class="number">1</span>, n - <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span></div><div class="line">        randselect1(m, n - <span class="number">1</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>书中问题</p>
<ol>
<li>该方法是降序排列，如何使得按升序输出<br>我的想法<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">void</span> randselect2(<span class="keyword">int</span> m, <span class="keyword">int</span> <span class="built_in">begin</span>, <span class="keyword">int</span> n)</div><div class="line">&#123;</div><div class="line">    <span class="built_in">if</span>(m &lt;= <span class="number">0</span> || <span class="built_in">begin</span> &gt;= n)</div><div class="line">        <span class="built_in">return</span>;</div><div class="line">    <span class="built_in">if</span>((bigrand() % (n - <span class="built_in">begin</span>)) &lt; m)</div><div class="line">    &#123;</div><div class="line">        printf(<span class="string">"%d "</span>, <span class="built_in">begin</span>);</div><div class="line">        randselect2(m - <span class="number">1</span>, <span class="built_in">begin</span> + <span class="number">1</span>, n);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">else</span></div><div class="line">        randselect2(m, <span class="built_in">begin</span> + <span class="number">1</span>, n);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>简单测试了一下应该是对的，但是真的太丑陋了啊</p>
<p>标准答案：只要将printf和randselect对调位置就行了，这其实是最简单的递归原理<br>举个最简单无聊的例子<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//逆序输出n..1</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">printn</span><span class="params">(<span class="keyword">int</span> n)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(n &lt;= <span class="number">0</span>)</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d "</span>, n);</div><div class="line">    printn(n - <span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="comment">//顺序输出1..n</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">printn1</span><span class="params">(<span class="keyword">int</span> n)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(n &lt;= <span class="number">0</span>)</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    printn1(n - <span class="number">1</span>);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d "</span>, n);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ol>
<li>利用该程序结构生成0..n-1的所有m元子集<br>书中没有给出答案，原来这还是一个经典的算法题</li>
</ol>
<p>我的做法<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//m表示剩余选择的个数</span></div><div class="line"><span class="comment">//begin表示从第几个开始选</span></div><div class="line"><span class="comment">//n表示数组总长度，是固定不动的</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">selectm</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> begin, <span class="keyword">int</span> n, <span class="built_in">std</span>::<span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; s)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="comment">//m为1时，表示从剩下的数中选择一个</span></div><div class="line">    <span class="keyword">if</span>(m == <span class="number">1</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = begin; i &lt; n; ++i)</div><div class="line">        &#123;</div><div class="line">            <span class="comment">//set里保存了前m-1个数</span></div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j : s)</div><div class="line">                <span class="built_in">printf</span>(<span class="string">"%d "</span>, j);</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, i);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(n - begin &gt;= m)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = begin; i &lt;= n - m; ++i)</div><div class="line">        &#123;</div><div class="line">            s.insert(i); <span class="comment">//测试选择i的情况</span></div><div class="line">            selectm(m - <span class="number">1</span>, i + <span class="number">1</span>, n, s);</div><div class="line">            s.erase(i);  <span class="comment">//测试完成之后需要删除i，从而后面选择i+1...</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>2018-03-15更新<br>修改为如下，可能更清晰一些<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//在[begin..n-1]之间选择m个数</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">selectm</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> begin, <span class="keyword">int</span> n, <span class="built_in">std</span>::<span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; &amp;s)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(m == <span class="number">0</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i : s)</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d "</span>, i);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(n - begin &lt; m)</div><div class="line">        <span class="keyword">return</span>;      <span class="comment">//剩下的数不够选了</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = begin; i &lt; n; ++i)</div><div class="line">    &#123;</div><div class="line">        s.insert(i);</div><div class="line">        selectm(m - <span class="number">1</span>, i + <span class="number">1</span>, n, s);</div><div class="line">        s.erase(i);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>经测试，selectm(4, 0, 7, s)的结果如下<br><figure class="highlight basic"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">0 </span><span class="number">1</span> <span class="number">2</span> <span class="number">3</span></div><div class="line"><span class="symbol">0 </span><span class="number">1</span> <span class="number">2</span> <span class="number">4</span></div><div class="line"><span class="symbol">0 </span><span class="number">1</span> <span class="number">2</span> <span class="number">5</span></div><div class="line"><span class="symbol">0 </span><span class="number">1</span> <span class="number">2</span> <span class="number">6</span></div><div class="line"><span class="symbol">0 </span><span class="number">1</span> <span class="number">3</span> <span class="number">4</span></div><div class="line"><span class="symbol">0 </span><span class="number">1</span> <span class="number">3</span> <span class="number">5</span></div><div class="line"><span class="symbol">0 </span><span class="number">1</span> <span class="number">3</span> <span class="number">6</span></div><div class="line"><span class="symbol">0 </span><span class="number">1</span> <span class="number">4</span> <span class="number">5</span></div><div class="line"><span class="symbol">0 </span><span class="number">1</span> <span class="number">4</span> <span class="number">6</span></div><div class="line"><span class="symbol">0 </span><span class="number">1</span> <span class="number">5</span> <span class="number">6</span></div><div class="line"><span class="symbol">0 </span><span class="number">2</span> <span class="number">3</span> <span class="number">4</span></div><div class="line"><span class="symbol">0 </span><span class="number">2</span> <span class="number">3</span> <span class="number">5</span></div><div class="line"><span class="symbol">0 </span><span class="number">2</span> <span class="number">3</span> <span class="number">6</span></div><div class="line"><span class="symbol">0 </span><span class="number">2</span> <span class="number">4</span> <span class="number">5</span></div><div class="line"><span class="symbol">0 </span><span class="number">2</span> <span class="number">4</span> <span class="number">6</span></div><div class="line"><span class="symbol">0 </span><span class="number">2</span> <span class="number">5</span> <span class="number">6</span></div><div class="line"><span class="symbol">0 </span><span class="number">3</span> <span class="number">4</span> <span class="number">5</span></div><div class="line"><span class="symbol">0 </span><span class="number">3</span> <span class="number">4</span> <span class="number">6</span></div><div class="line"><span class="symbol">0 </span><span class="number">3</span> <span class="number">5</span> <span class="number">6</span></div><div class="line"><span class="symbol">0 </span><span class="number">4</span> <span class="number">5</span> <span class="number">6</span></div><div class="line"><span class="symbol">1 </span><span class="number">2</span> <span class="number">3</span> <span class="number">4</span></div><div class="line"><span class="symbol">1 </span><span class="number">2</span> <span class="number">3</span> <span class="number">5</span></div><div class="line"><span class="symbol">1 </span><span class="number">2</span> <span class="number">3</span> <span class="number">6</span></div><div class="line"><span class="symbol">1 </span><span class="number">2</span> <span class="number">4</span> <span class="number">5</span></div><div class="line"><span class="symbol">1 </span><span class="number">2</span> <span class="number">4</span> <span class="number">6</span></div><div class="line"><span class="symbol">1 </span><span class="number">2</span> <span class="number">5</span> <span class="number">6</span></div><div class="line"><span class="symbol">1 </span><span class="number">3</span> <span class="number">4</span> <span class="number">5</span></div><div class="line"><span class="symbol">1 </span><span class="number">3</span> <span class="number">4</span> <span class="number">6</span></div><div class="line"><span class="symbol">1 </span><span class="number">3</span> <span class="number">5</span> <span class="number">6</span></div><div class="line"><span class="symbol">1 </span><span class="number">4</span> <span class="number">5</span> <span class="number">6</span></div><div class="line"><span class="symbol">2 </span><span class="number">3</span> <span class="number">4</span> <span class="number">5</span></div><div class="line"><span class="symbol">2 </span><span class="number">3</span> <span class="number">4</span> <span class="number">6</span></div><div class="line"><span class="symbol">2 </span><span class="number">3</span> <span class="number">5</span> <span class="number">6</span></div><div class="line"><span class="symbol">2 </span><span class="number">4</span> <span class="number">5</span> <span class="number">6</span></div><div class="line"><span class="symbol">3 </span><span class="number">4</span> <span class="number">5</span> <span class="number">6</span></div></pre></td></tr></table></figure></p>
<p>数目为35（C<sub>n</sub><sup>m</sup>=n!/(m! * (n - m)!)）个，应该是对的，只是还不够优雅。</p>
<p>为了便于理解，通过在首行加上相应log，相应输出如下<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="string">m:</span><span class="number">4</span>, <span class="string">begin:</span><span class="number">0</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span>          <span class="comment">//已选择数为空，从0~6选择4个数</span></div><div class="line"><span class="string">m:</span><span class="number">3</span>, <span class="string">begin:</span><span class="number">1</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">0</span>         <span class="comment">//已选择数字0，从1~6选择3个数</span></div><div class="line"><span class="string">m:</span><span class="number">2</span>, <span class="string">begin:</span><span class="number">2</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">0</span> <span class="number">1</span>       <span class="comment">//已选择数字0,1，从2~6选择2个数</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">3</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">0</span> <span class="number">1</span> <span class="number">2</span>     <span class="comment">//已选择数字0,1,2，从3~6选择1个数</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">4</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">0</span> <span class="number">1</span> <span class="number">3</span>     <span class="comment">//已选择数字0,1,3，从4~6选择1个数</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">5</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">0</span> <span class="number">1</span> <span class="number">4</span>     <span class="comment">//已选择数字0,1,4，从5~6选择1个数</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">6</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">0</span> <span class="number">1</span> <span class="number">5</span>     <span class="comment">//已选择数字0,1,5，从6~6选择1个数</span></div><div class="line"><span class="string">m:</span><span class="number">2</span>, <span class="string">begin:</span><span class="number">3</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">0</span> <span class="number">2</span>       <span class="comment">//已选择数字0,2，从3~6选择2个数</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">4</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">0</span> <span class="number">2</span> <span class="number">3</span>     <span class="comment">//下同，不在赘述</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">5</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">0</span> <span class="number">2</span> <span class="number">4</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">6</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">0</span> <span class="number">2</span> <span class="number">5</span></div><div class="line"><span class="string">m:</span><span class="number">2</span>, <span class="string">begin:</span><span class="number">4</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">0</span> <span class="number">3</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">5</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">0</span> <span class="number">3</span> <span class="number">4</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">6</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">0</span> <span class="number">3</span> <span class="number">5</span></div><div class="line"><span class="string">m:</span><span class="number">2</span>, <span class="string">begin:</span><span class="number">5</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">0</span> <span class="number">4</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">6</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">0</span> <span class="number">4</span> <span class="number">5</span></div><div class="line"><span class="string">m:</span><span class="number">3</span>, <span class="string">begin:</span><span class="number">2</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">1</span></div><div class="line"><span class="string">m:</span><span class="number">2</span>, <span class="string">begin:</span><span class="number">3</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">1</span> <span class="number">2</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">4</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">1</span> <span class="number">2</span> <span class="number">3</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">5</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">1</span> <span class="number">2</span> <span class="number">4</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">6</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">1</span> <span class="number">2</span> <span class="number">5</span></div><div class="line"><span class="string">m:</span><span class="number">2</span>, <span class="string">begin:</span><span class="number">4</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">1</span> <span class="number">3</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">5</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">1</span> <span class="number">3</span> <span class="number">4</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">6</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">1</span> <span class="number">3</span> <span class="number">5</span></div><div class="line"><span class="string">m:</span><span class="number">2</span>, <span class="string">begin:</span><span class="number">5</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">1</span> <span class="number">4</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">6</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">1</span> <span class="number">4</span> <span class="number">5</span></div><div class="line"><span class="string">m:</span><span class="number">3</span>, <span class="string">begin:</span><span class="number">3</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">2</span></div><div class="line"><span class="string">m:</span><span class="number">2</span>, <span class="string">begin:</span><span class="number">4</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">2</span> <span class="number">3</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">5</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">2</span> <span class="number">3</span> <span class="number">4</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">6</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">2</span> <span class="number">3</span> <span class="number">5</span></div><div class="line"><span class="string">m:</span><span class="number">2</span>, <span class="string">begin:</span><span class="number">5</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">2</span> <span class="number">4</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">6</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">2</span> <span class="number">4</span> <span class="number">5</span></div><div class="line"><span class="string">m:</span><span class="number">3</span>, <span class="string">begin:</span><span class="number">4</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">3</span></div><div class="line"><span class="string">m:</span><span class="number">2</span>, <span class="string">begin:</span><span class="number">5</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">3</span> <span class="number">4</span></div><div class="line"><span class="string">m:</span><span class="number">1</span>, <span class="string">begin:</span><span class="number">6</span>, <span class="string">n:</span><span class="number">7</span>, cur <span class="string">set :</span><span class="number">3</span> <span class="number">4</span> <span class="number">5</span></div></pre></td></tr></table></figure></p>
<p>网上别人的做法，参考：<a href="https://www.cnblogs.com/Quincy/p/4837727.html" target="_blank" rel="external">链接</a><br><figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> selectm(<span class="keyword">int</span> <span class="keyword">m</span>, <span class="keyword">int</span> n)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> *<span class="keyword">state</span> = new <span class="keyword">int</span>[<span class="keyword">m</span>];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">m</span>; ++i)</div><div class="line">        <span class="keyword">state</span>[i] = i;</div><div class="line">    <span class="keyword">int</span> count = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">m</span>; ++i)</div><div class="line">        <span class="keyword">printf</span>(<span class="string">"%d "</span>, <span class="keyword">state</span>[i]);</div><div class="line">    <span class="keyword">printf</span>(<span class="string">"\n"</span>);</div><div class="line">    <span class="keyword">int</span> npos = <span class="keyword">m</span> - <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span>(<span class="keyword">state</span>[<span class="number">0</span>] &lt; n - <span class="keyword">m</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">state</span>[<span class="keyword">m</span> - <span class="number">1</span>] == n - <span class="number">1</span>)</div><div class="line">            --npos;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            npos = <span class="keyword">m</span> - <span class="number">1</span>;</div><div class="line">        <span class="keyword">state</span>[npos]++;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = npos + <span class="number">1</span>; i &lt; <span class="keyword">m</span>; ++i)</div><div class="line">            <span class="keyword">state</span>[i] = <span class="keyword">state</span>[i - <span class="number">1</span>] + <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">m</span>; ++i)</div><div class="line">            <span class="keyword">printf</span>(<span class="string">"%d "</span>, <span class="keyword">state</span>[i]);</div><div class="line">        <span class="keyword">printf</span>(<span class="string">"\n"</span>);</div><div class="line">        ++count;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">delete</span> []<span class="keyword">state</span>;</div><div class="line">    <span class="keyword">return</span> count;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>也不是很优雅</p>
<ul>
<li><p>题目9<br>上面方案二基于集合的算法，当m接近于n时，生成的很多随机数都要丢掉，因为他们已经存在于集合中。<br>Bob Floyd给出，在最坏情况下，也只需要生成m个随机数的算法</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">randseries4</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">std</span>::<span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; s;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = n - m; i &lt; n; ++i)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> t = bigrand() % (i + <span class="number">1</span>);</div><div class="line">        <span class="keyword">if</span>(s.find(t) == s.end())</div><div class="line">            s.insert(t);        <span class="comment">// t is not in s</span></div><div class="line">        <span class="keyword">else</span></div><div class="line">            s.insert(i);        <span class="comment">// t in s</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i : s)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, i);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>题目10<br>如何从n个对象（可以依次看到这n个对象，但事先不知道n的值）中随机选择一个<br>具体来说，如何在事先不知道文本文件行数的情况下读取该文件，从中速记选择并输出一行</p>
</li>
</ul>
<ol>
<li><p>思路<br>总选择（以100%概率）第1行<br>以概率1/2选择第2行（如果有的话）<br>以概率1/3选择第3行（如果有的话）<br>..<br>如此结束后，每一行的选中概率都是相等的（1/n，n是文件的总行数）</p>
</li>
<li><p>伪代码</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">i</span> = <span class="number">0</span></div><div class="line">while more <span class="selector-tag">input</span> lines</div><div class="line">    with probability <span class="number">1.0</span> / ++<span class="selector-tag">i</span></div><div class="line">        choice = this <span class="selector-tag">input</span> line</div><div class="line">print choice</div></pre></td></tr></table></figure>
</li>
<li><p>实现</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">printFileLine</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *fname)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">std</span>::<span class="function">ifstream <span class="title">in</span><span class="params">(fname)</span></span>;</div><div class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">    <span class="keyword">char</span> line[<span class="number">50</span>];</div><div class="line">    <span class="keyword">char</span> choice[<span class="number">50</span>];</div><div class="line">    <span class="keyword">while</span>(!in.eof())</div><div class="line">    &#123;</div><div class="line">        in &gt;&gt; line;</div><div class="line">        <span class="keyword">if</span>((bigrand() % (++i)) &lt; <span class="number">1</span>)</div><div class="line">            <span class="built_in">strcpy</span>(choice, line);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"choice:%s\n"</span>, choice);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="第13章"><a href="#第13章" class="headerlink" title="第13章"></a>第13章</h1><p>本章讲搜索，主要讨论上一章的问题：生成[0, maxval]内m个随机整数生成，保存到集合中，该集合IntSet的实现方法。<br>包含有序集合的创建，插入，遍历等。</p>
<p>通用接口如下：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">IntSetImp</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span>:</div><div class="line">        IntSetImp(<span class="keyword">int</span> maxelements, <span class="keyword">int</span> maxval);</div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> t)</span></span>;</div><div class="line">        <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>;</div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">report</span><span class="params">(<span class="keyword">int</span> *v)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>其中，构造参数分别表示集合元素的最大个数和集合元素的最大值（加1）；insert函数向集合中添加一个新的整数（如果已存在就忽略）；size返回当前元素个数；report将元素写入向量v中。</p>
<p>实现方式有以下几种</p>
<ol>
<li>利用标准库set</li>
<li>数组</li>
<li>链表</li>
<li>二叉搜索树</li>
<li>位向量</li>
<li>箱<br>下面，一一实现一下</li>
</ol>
<ul>
<li>使用标准模板库set<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">IntSetSTL</span></span></div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    IntSetSTL(<span class="keyword">int</span> maxelements, <span class="keyword">int</span> maxval) &#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> t)</span> </span>&#123; s.insert(t); &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> s.size(); &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">report</span><span class="params">(<span class="keyword">int</span> *v)</span> <span class="keyword">const</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        <span class="comment">//书中使用迭代器遍历，这里用C++11新特性</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> data : s) </div><div class="line">            v[i++] = data;</div><div class="line">    &#125;</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="built_in">std</span>::<span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; s;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>优点简单清晰，但是时间空间效率都不高</p>
<ul>
<li>使用数组<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">IntSetArr</span></span></div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    IntSetArr(<span class="keyword">int</span> maxelements, <span class="keyword">int</span> maxval)</div><div class="line">    &#123;</div><div class="line">        arr_ = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">1</span> + maxelements];</div><div class="line">        n_ = <span class="number">0</span>;</div><div class="line">        <span class="comment">//哨兵元素，放置在已排序元素的最后（maxval比集合中任何元素都大）</span></div><div class="line">        <span class="comment">//下面的insert利用了该哨兵</span></div><div class="line">        arr_[<span class="number">0</span>] = maxval;        </div><div class="line">    &#125;</div><div class="line">    ~IntSetArr() &#123; <span class="keyword">delete</span> []arr_; &#125;</div><div class="line">    <span class="comment">//书中insert实现</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> t)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> i;</div><div class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; arr_[i] &lt; t; ++i)</div><div class="line">            ;</div><div class="line">        <span class="keyword">if</span>(arr_[i] == t) <span class="comment">//元素已存在</span></div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = n_; j &gt;= i; --j)</div><div class="line">            arr_[j + <span class="number">1</span>] = arr_[j];</div><div class="line">        arr_[i] = t;</div><div class="line">        n_++;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//我本想实现成下面这样类似于插入排序的更简单的方式</span></div><div class="line">    <span class="comment">//但这种方式不好避免元素出现重复的情况，要加很多判断，很啰嗦</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert1</span><span class="params">(<span class="keyword">int</span> t)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> i;</div><div class="line">        <span class="keyword">for</span>(i = n_; i &gt; <span class="number">0</span> &amp;&amp; arr_[i - <span class="number">1</span>] &gt; t; --i)</div><div class="line">            arr_[i] = arr_[i - <span class="number">1</span>];</div><div class="line">        arr_[i] = t;</div><div class="line">        n_++;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> n_; &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">report</span><span class="params">(<span class="keyword">int</span> *v)</span> <span class="keyword">const</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n_; ++i)</div><div class="line">            v[i] = arr_[i];</div><div class="line">    &#125;</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="keyword">int</span> n_;</div><div class="line">    <span class="keyword">int</span> *arr_;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>在已知set大小的情况下，使用数组还比较合理。但是插入元素时，需要移动的元素比较多。</p>
<p>注意上面的insert方法</p>
<ul>
<li>使用链表<br>在集合大小未知的情况下，链表是首选，而且插入元素开销较小（不需要移动）<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line">class IntSetList</div><div class="line">&#123;</div><div class="line">public:</div><div class="line">    IntSetList(int maxelements, int maxval)</div><div class="line">    &#123;</div><div class="line">        n_ = <span class="number">0</span>;</div><div class="line">        //sentinel_始终指向最大元素节点</div><div class="line">        //head_始终指向头结点(也是有效的数据节点)</div><div class="line">        sentinel_ = head_  = new <span class="keyword">Node</span><span class="title">(maxval</span>);</div><div class="line">    &#125;</div><div class="line">    ~IntSetList()</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">Node</span> <span class="title">*p</span> = head_, *q;</div><div class="line">        while(p)</div><div class="line">        &#123;</div><div class="line">            q = p-&gt;next_;</div><div class="line">            delete p;</div><div class="line">            p = q;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    int size() const &#123; return n_; &#125;</div><div class="line">    //书中递归版</div><div class="line">    void insert(int t)</div><div class="line">    &#123;</div><div class="line">        head_ = rinsert(head_, t);</div><div class="line">    &#125;</div><div class="line">    //自写迭代版</div><div class="line">    void insert1(int t)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">Node</span> <span class="title">*p</span> = head_, *q = head_;</div><div class="line">        while(p != sentinel_ &amp;&amp; p-&gt;data_ <span class="tag">&lt; t)</span></div><div class="line">        &#123;</div><div class="line">            //q始终指向p的前一个（如果有的话）</div><div class="line">            q = p;</div><div class="line">            p = p-&gt;next_;</div><div class="line">        &#125;</div><div class="line">        //循环结束之后，p指向的data应当&gt;=t</div><div class="line">        //如果==t，则已存在，返回</div><div class="line">        if(p-&gt;data_ == t)</div><div class="line">            return;</div><div class="line">        n_++;</div><div class="line">        //如果p指向的是头结点，即待插入的节点值是最小的</div><div class="line">        //则需要将新建节点赋值给head</div><div class="line">        if(p == head_)</div><div class="line">            head_ = new <span class="keyword">Node</span><span class="title">(t</span>, p);</div><div class="line">        else</div><div class="line">            q-&gt;next_ = new <span class="keyword">Node</span><span class="title">(t</span>, q-&gt;next_);</div><div class="line">    &#125;</div><div class="line">    void report(int *v) const</div><div class="line">    &#123;</div><div class="line">        int i = <span class="number">0</span>;</div><div class="line">        //for(<span class="keyword">Node</span> <span class="title">*p</span> = head_-&gt;next_; p != nullptr; p = p-&gt;next_)</div><div class="line">        for(<span class="keyword">Node</span> <span class="title">*p</span> = head_; p != sentinel_; p = p-&gt;next_)</div><div class="line">            v[i++] = p-&gt;data_;</div><div class="line">    &#125;</div><div class="line">private:</div><div class="line">    int n_;</div><div class="line">    struct <span class="keyword">Node</span></div><div class="line">    <span class="title">&#123;</span></div><div class="line">        int data_;</div><div class="line">        <span class="keyword">Node</span> <span class="title">*next_</span>;</div><div class="line">        <span class="keyword">Node</span><span class="title">(int</span> data = <span class="number">0</span>, <span class="keyword">Node</span> <span class="title">*next</span> = nullptr)</div><div class="line">            : data_(data), next_(next) &#123;&#125;</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">Node</span> <span class="title">*head_</span>, *sentinel_;</div><div class="line">    <span class="keyword">Node</span> <span class="title">*rinsert</span>(<span class="keyword">Node</span> <span class="title">*p</span>, int t)</div><div class="line">    &#123;</div><div class="line">        if(p-&gt;data_ <span class="tag">&lt; t)</span></div><div class="line">            p-&gt;next_ = rinsert(p-&gt;next_, t);</div><div class="line">        else if(p-&gt;data_ &gt; t)</div><div class="line">        &#123;</div><div class="line">            p = new <span class="keyword">Node</span><span class="title">(t</span>, p);</div><div class="line">            n_++;</div><div class="line">        &#125;</div><div class="line">        return p;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>也比较好理解，需要注意的是insert函数，分别实现了递归版和迭代版，显然递归版更加清晰一些。</p>
<ul>
<li>使用二分搜索树<br>参考<a href="../../../../2018/01/05/C++中常见数据结构的实现/#二叉查找树">二叉查找树</a></li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">IntSetBST</span></span></div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    IntSetBST(<span class="keyword">int</span> maxelements, <span class="keyword">int</span> maxval)</div><div class="line">    &#123;</div><div class="line">        root_ = <span class="literal">nullptr</span>;</div><div class="line">        n_ = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> n_; &#125;</div><div class="line">    <span class="comment">//书中递归版本</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> t)</span></span></div><div class="line">    &#123;</div><div class="line">        rinsert(t, root_);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//自写迭代版本</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert1</span><span class="params">(<span class="keyword">int</span> t)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(root_ == <span class="literal">nullptr</span>)</div><div class="line">        &#123;</div><div class="line">            root_ = <span class="keyword">new</span> Node(t);</div><div class="line">            n_++;</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        Node *p = root_, *q = root_;</div><div class="line">        <span class="keyword">bool</span> isleft = <span class="literal">true</span>;</div><div class="line">        <span class="keyword">while</span>(p)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(t == p-&gt;data_)</div><div class="line">                <span class="keyword">return</span>;      <span class="comment">//相等，不插入</span></div><div class="line">            <span class="comment">//q始终指向p的父节点（如果有的话）</span></div><div class="line">            q = p;</div><div class="line">            <span class="keyword">if</span>(t &lt; p-&gt;data_)</div><div class="line">            &#123;</div><div class="line">                p = p-&gt;left_;</div><div class="line">                isleft = <span class="literal">true</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span></div><div class="line">            &#123;</div><div class="line">                p = p-&gt;right_;</div><div class="line">                isleft = <span class="literal">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        n_++;</div><div class="line">        <span class="keyword">if</span>(isleft)</div><div class="line">            q-&gt;left_ = <span class="keyword">new</span> Node(t);</div><div class="line">        <span class="keyword">else</span></div><div class="line">            q-&gt;right_ = <span class="keyword">new</span> Node(t);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">report</span><span class="params">(<span class="keyword">int</span> *v)</span> <span class="keyword">const</span></span></div><div class="line">    &#123;</div><div class="line">        traverse(v, root_);</div><div class="line">    &#125;</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> data_;</div><div class="line">        Node *left_, *right_;</div><div class="line">        Node(<span class="keyword">int</span> data=<span class="number">0</span>, Node *left=<span class="literal">nullptr</span>, Node *right=<span class="literal">nullptr</span>)</div><div class="line">            : data_(data), left_(left), right_(right) &#123;&#125;</div><div class="line">    &#125;;</div><div class="line">    Node *root_;</div><div class="line">    <span class="keyword">int</span> n_;</div><div class="line">    <span class="comment">//和书中略有不同，书中rinsert有返回值，从而Node *p不需要使用引用参数</span></div><div class="line">    <span class="comment">//本质是一样的</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rinsert</span><span class="params">(<span class="keyword">int</span> t, Node *&amp;p)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(!p)</div><div class="line">        &#123;</div><div class="line">            p = <span class="keyword">new</span> Node(t);</div><div class="line">            n_++;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(t &lt; p-&gt;data_)</div><div class="line">            rinsert(t, p-&gt;left_);</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(p-&gt;data_ &lt; t)</div><div class="line">            rinsert(t, p-&gt;right_);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//和书中略有不同，书中使用成员变量索引vn</span></div><div class="line">    <span class="comment">//每次访问索引vn自增，从而不需要传递数组指针参数</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">traverse</span><span class="params">(<span class="keyword">int</span> *&amp;v, Node *p)</span> <span class="keyword">const</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(!p)</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        traverse(v, p-&gt;left_);</div><div class="line">        *v++ = p-&gt;data_;</div><div class="line">        traverse(v, p-&gt;right_);</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>二分搜索树支持快速插入和搜索。</p>
<p>之前这几个数据结构都是比较好想的，下面的才是真正快速的，前方高能。</p>
<ul>
<li>使用位向量<br>位向量的妙用在第一章已经见识过了<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">IntSetBitVec</span></span></div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    IntSetBitVec(<span class="keyword">int</span> maxelements, <span class="keyword">int</span> maxval)</div><div class="line">    &#123;</div><div class="line">        hi_ = maxval;</div><div class="line">        n_ = <span class="number">0</span>;</div><div class="line">        arr_ = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">1</span> + hi_ / BITSPERWORD]&#123;<span class="number">0</span>&#125;;</div><div class="line">        <span class="comment">//书中这里还加上了clr处理，但我觉得这是不必要的</span></div><div class="line">        <span class="comment">//因为new int[n]&#123;0&#125;，已经将每一项置为0了</span></div><div class="line">    &#125;</div><div class="line">    ~IntSetBitVec() &#123; <span class="keyword">delete</span> []arr_; &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> n_; &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> t)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(test(t))</div><div class="line">            <span class="keyword">return</span>; </div><div class="line">        <span class="built_in">set</span>(t); </div><div class="line">        n_++;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">report</span><span class="params">(<span class="keyword">int</span> *v)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> j = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; hi_; ++i)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(test(i))</div><div class="line">                v[j++] = i;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="keyword">enum</span> &#123;BITSPERWORD = <span class="number">32</span>, SHIFT = <span class="number">5</span>, MASK = <span class="number">0x1F</span>&#125;;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;        arr_[i &gt;&gt; SHIFT] |=  (<span class="number">1</span> &lt;&lt; (i &amp; MASK)); &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clr</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;        arr_[i &gt;&gt; SHIFT] &amp;= ~(<span class="number">1</span> &lt;&lt; (i &amp; MASK)); &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">test</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123; <span class="keyword">return</span> arr_[i &gt;&gt; SHIFT] &amp;   (<span class="number">1</span> &lt;&lt; (i &amp; MASK)); &#125;</div><div class="line">    <span class="keyword">int</span> n_;</div><div class="line">    <span class="keyword">int</span> hi_;</div><div class="line">    <span class="keyword">int</span> *arr_;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>完美的利用了位向量的特点，相对于纯数组来说，存储空间大大减小。<br>但是对于最大值很大的情况，存储空间消耗依然非常严重，比如要在2<sup>32</sup>个数中选择两个，所需要的数组长度竟然是1+2<sup>27</sup>，这显然是巨大的浪费</p>
<ul>
<li>使用箱序列<br>箱，听名字感觉好高大上，其实就是就是结合了链表和位向量。怎么理解？<br>比如要在0~99范围内选择4个整数，则需要4个箱：</li>
</ul>
<ol>
<li>箱0表示 0~24范围内的整数</li>
<li>箱1表示25~49范围内的整数</li>
<li>箱2表示50~74范围内的整数</li>
<li>箱3表示75~99范围内的整数<br>如果选出的4个数正好分别落在4个区间内，则每个箱正好有1个整数。可是如果选出的<br>数是{20, 31, 41, 59}呢，那么箱1就需要表示两个整数（用链表表示），箱3表示0个整数</li>
</ol>
<p>但是由于整数是均匀分别的，索引每个链表的期望长度都为1。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">IntSetBins</span></span></div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    IntSetBins(<span class="keyword">int</span> maxelements, <span class="keyword">int</span> maxval)</div><div class="line">    &#123;</div><div class="line">        maxval_ = maxval;</div><div class="line">        <span class="comment">//表示有多少个箱子</span></div><div class="line">        bins_ = maxelements;</div><div class="line">        <span class="comment">//指针数组，每个成员指向每个箱子的头结点</span></div><div class="line">        bin = <span class="keyword">new</span> Node*[maxelements];</div><div class="line">        sentinel_ = <span class="keyword">new</span> Node(maxval);</div><div class="line">        <span class="comment">//每个箱子的头结点初始化为哨兵节点</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bins_; ++i)</div><div class="line">            bin[i] = sentinel_;</div><div class="line">        n_ = <span class="number">0</span>;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> n_; &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> t)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="comment">//接下来就需要映射了，类似于位向量那样，将t映射到某个箱子</span></div><div class="line">        <span class="keyword">int</span> i = t /(<span class="number">1</span> + maxval_ / bins_);</div><div class="line">        <span class="comment">//书中说如下映射会带来麻烦，还没理解</span></div><div class="line">        <span class="comment">//int i = t * bins / maxval_;</span></div><div class="line">        bin[i] = rinsert(bin[i], t);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">report</span><span class="params">(<span class="keyword">int</span> *v)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> j = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bins_; ++i)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">for</span>(Node *p = bin[i]; p != sentinel_; p = p-&gt;next_)</div><div class="line">                v[j++] = p-&gt;data_;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="keyword">int</span> n_, bins_;</div><div class="line">    <span class="keyword">int</span> maxval_;</div><div class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> data_;</div><div class="line">        Node *next_;</div><div class="line">        Node(<span class="keyword">int</span> data = <span class="number">0</span>, Node *next = <span class="literal">nullptr</span>)</div><div class="line">            : data_(data), next_(next) &#123;&#125;</div><div class="line">    &#125;;</div><div class="line">    Node **bin, *sentinel_;</div><div class="line">    <span class="comment">//类似于纯链表的情况</span></div><div class="line">    <span class="function">Node *<span class="title">rinsert</span><span class="params">(Node *p, <span class="keyword">int</span> t)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(p-&gt;data_ &lt; t)</div><div class="line">            p-&gt;next_ = rinsert(p-&gt;next_, t);</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(p-&gt;data_ &gt; t)</div><div class="line">        &#123;</div><div class="line">            p = <span class="keyword">new</span> Node(t, p);</div><div class="line">            n_++;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> p;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>还是比较好理解的，其实总结而言就一句：将单纯的链表映射到各个箱的分散的单链表中。由于数据分散的特点，每个单链表长度期望为1</p>
<h2 id="习题-1"><a href="#习题-1" class="headerlink" title="习题"></a>习题</h2><ul>
<li>题目4<br>实现链表、箱、二分搜索树插入的迭代版本</li>
</ul>
<ol>
<li>链表的插入迭代版本<br>我自己的实现参考上面的，书中给出两种实现<br>实现1<figure class="highlight zephir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">void insert(<span class="keyword">int</span> t)</div><div class="line">&#123;</div><div class="line">    <span class="comment">//head节点值等于带插入节点值，返回</span></div><div class="line">    <span class="keyword">if</span>(head_-&gt;data_ == t)</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    <span class="comment">//head节点值比待插入节点大，则新增节点要设为head</span></div><div class="line">    <span class="keyword">if</span>(head_-&gt;data_ &gt; t)</div><div class="line">    &#123;</div><div class="line">        head_ = <span class="keyword">new</span> Node(t, head_);</div><div class="line">        n_++;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    Node *p;</div><div class="line">    <span class="keyword">for</span>(p = head_; p-&gt;next_-&gt;data_ &lt; t; p = p-&gt;next_)</div><div class="line">        ;</div><div class="line">    <span class="comment">//循环结束之后p的下一个节点的值&gt;=t</span></div><div class="line">    <span class="keyword">if</span>(p-&gt;next_-&gt;data_ == t)</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    p-&gt;next_ = <span class="keyword">new</span> Node(t, p-&gt;next_);</div><div class="line">    n_++;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>使用指向指针的指针来去除重复<br><figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="literal">void</span> insert(int t)</div><div class="line">&#123;</div><div class="line">    Node **p;</div><div class="line">    <span class="keyword">for</span><span class="function"><span class="params">(p = &amp;head_; (*p)-&gt;data_ &lt; t; p = &amp;((*p)-&gt;next_))</span>;</span></div><div class="line">        ;</div><div class="line">    <span class="title">if</span><span class="params">((*p)-&gt;data_ == t)</span></div><div class="line">        <span class="title">return</span>;</div><div class="line">    <span class="title">n_</span>++;</div><div class="line">    *<span class="title">p</span> = <span class="title">new</span> <span class="title">Node</span><span class="params">(t, *p)</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这段代码还是比较精妙的，为什么使用指针的指针就可以消除重复了？来看几种情况<br>一开始链表为空，head指向最大元素200<br>. 这时插入元素100，则for循环一次不走退出；p为指向head的指针<br>  则最后一个赋值语句等价于head<em> = new Node(t, head</em>)，成功赋值头结点<br>. 再插入元素90，等价于上面的情况<br>. 再插入元素95，for循环退出时，p为指向节点100的指针。<br>  最后一个赋值语句，将原本的节点100，修改成了节点95，并且节点95的下一个节点为节点100，则插入完成</p>
<ul>
<li><p>题目7<br>使用哨兵节点和整块申请内存，优化二叉搜索树</p>
</li>
<li><p>题目9<br>用低开销的逻辑移位替代高开销的除法运算。</p>
</li>
</ul>
<h1 id="第14章"><a href="#第14章" class="headerlink" title="第14章"></a>第14章</h1><p>本章主要讲堆，参考</p>
<ul>
<li><a href="../../../../2018/01/05/C++中常见数据结构的实现/#优先队列（堆）">优先队列（堆）</a></li>
<li><a href="../../../../2017/12/30/常见排序算法C++实现/#堆排序">堆排序</a></li>
</ul>
<p>结合两本书所述，再给出堆排序算法（index从0开始）<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">void</span> siftdown(<span class="keyword">int</span> arr[], <span class="keyword">int</span> <span class="built_in">size</span>, <span class="keyword">int</span> hole)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> child;</div><div class="line">    <span class="keyword">int</span> t = arr[hole];</div><div class="line">    <span class="built_in">for</span>(;hole &lt;= <span class="built_in">size</span> / <span class="number">2</span> - <span class="number">1</span>; hole = child)</div><div class="line">    &#123;</div><div class="line">        child = <span class="number">2</span> * hole + <span class="number">1</span>;</div><div class="line">        <span class="built_in">if</span>(child &lt; <span class="built_in">size</span> - <span class="number">1</span> &amp;&amp; arr[child + <span class="number">1</span>] &gt; arr[child])</div><div class="line">            child++;</div><div class="line">        <span class="built_in">if</span>(arr[child] &gt; t)</div><div class="line">            arr[hole] = arr[child];</div><div class="line">        <span class="built_in">else</span></div><div class="line">            <span class="built_in">break</span>;</div><div class="line">    &#125;</div><div class="line">    arr[hole] = t;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> swap(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> &amp;b)</div><div class="line">&#123;</div><div class="line">    <span class="built_in">if</span>(a == b)</div><div class="line">        <span class="built_in">return</span>;</div><div class="line">    a = a ^ b;</div><div class="line">    b = a ^ b;</div><div class="line">    a = a ^ b;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> hsort(<span class="keyword">int</span> arr[], <span class="keyword">int</span> <span class="built_in">size</span>)</div><div class="line">&#123;</div><div class="line">    <span class="comment">//build heap</span></div><div class="line">    <span class="built_in">for</span>(<span class="keyword">int</span> i = <span class="built_in">size</span> / <span class="number">2</span> - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</div><div class="line">        siftdown(arr, <span class="built_in">size</span>, i);</div><div class="line">    <span class="built_in">for</span>(<span class="keyword">int</span> i = <span class="built_in">size</span> - <span class="number">1</span>; i &gt; <span class="number">0</span>; --i)</div><div class="line">    &#123;</div><div class="line">        swap(arr[<span class="number">0</span>], arr[i]);</div><div class="line">        siftdown(arr, i, <span class="number">0</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="第15章"><a href="#第15章" class="headerlink" title="第15章"></a>第15章</h1><h2 id="单词"><a href="#单词" class="headerlink" title="单词"></a>单词</h2><p>主要比较了C++标准库map/set和直接写C散列表的性能区别，参考<a href="../../../../2018/01/05/C++中常见数据结构的实现/#散列">散列表</a></p>
<h2 id="短语"><a href="#短语" class="headerlink" title="短语"></a>短语</h2><ul>
<li>查找字符串中最长重复子字符串<br>例如”Ask not what your country can do for you, but what you can do for your country”，中最长的重复字符串是”can do for you”，<br>第二长的是”your country”</li>
</ul>
<p>看到这道题，我最初的想法</p>
<ol>
<li>从最长的子串（长度为size-1）到最短的子串（长度为1）循环，找到则退出<br>，则退出时找到的子串就是最长的</li>
<li>以查找长度为len的子串为例，从首字母开始的子串开始，将每一个子串放到一个set中，如果set中已经包含该子串，则表示子串重复</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">findMaxDuplicate</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp;src)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> size = src.size();</div><div class="line">    <span class="built_in">std</span>::<span class="built_in">set</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; substrs;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> len = size - <span class="number">1</span>; len &gt;= <span class="number">1</span>; --len)</div><div class="line">    &#123;</div><div class="line">        substrs.clear();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= size - len; ++i)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">std</span>::<span class="built_in">string</span> subs = src.substr(i, len);</div><div class="line">            <span class="keyword">if</span>(substrs.find(subs) != substrs.end())</div><div class="line">            &#123;</div><div class="line">                <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"max sub is: "</span> &lt;&lt; subs &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span></div><div class="line">                substrs.insert(subs);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"max sub is empty"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>测试了一下结果应该是对的，但有两个缺点</p>
<ol>
<li>太依赖标准库set、string</li>
<li>题目的意思应该是重复的单词，而按这种方式求出来的前后可能带有空格，想要trim还有点麻烦</li>
</ol>
<p>书中算法一：<br>最直接的算法就是强行遍历每一个子串<br>伪代码<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">maxlen = -<span class="number">1</span></div><div class="line"><span class="keyword">for</span> <span class="selector-tag">i</span> = [<span class="number">0</span>, n)</div><div class="line">    <span class="keyword">for</span> j = (<span class="selector-tag">i</span>, n)</div><div class="line">        <span class="keyword">if</span> (thislen = comlen(&amp;c[i], &amp;c[j])) &gt; maxlen</div><div class="line">            maxlen = thislen</div><div class="line">            maxi = <span class="selector-tag">i</span></div><div class="line">            maxj = j</div><div class="line"><span class="comment">//comlen原型</span></div><div class="line">int comlen(char *<span class="selector-tag">p</span>, char *q)</div><div class="line">    <span class="selector-tag">i</span> = <span class="number">0</span></div><div class="line">    while *<span class="selector-tag">p</span> &amp;&amp; (*p++ == *q++)</div><div class="line">        i++</div><div class="line">    return i</div></pre></td></tr></table></figure></p>
<p>一个注意点：while循环是不需要同时判断p和q不指向’\0’的（后一个相等性判断已经保证），多写浪费<br>实现<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">findMaxDuplicate2</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *src)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> size = <span class="built_in">strlen</span>(src), maxlen = <span class="number">-1</span>,</div><div class="line">        maxi = <span class="number">0</span>, maxj = <span class="number">0</span>, thislen = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; ++i)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; size; ++j)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>((thislen = comlen(src + i, src + j)) &gt; maxlen)</div><div class="line">            &#123;</div><div class="line">                maxlen = thislen;</div><div class="line">                maxi = i;</div><div class="line">                maxj = j;</div><div class="line">                <span class="built_in">printf</span>(<span class="string">"maxlen:%d, maxi:%d, maxj:%d\n"</span>, thislen, i, j);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(maxlen != <span class="number">-1</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"max sub is: "</span>);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; maxlen; ++i)</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%c"</span>, src[maxi+ i]);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="built_in">printf</span>(<span class="string">"max sub is empty\n"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>很明显，效率也比较低</p>
<p>书中算法二：使用后缀数组</p>
<ol>
<li>什么是后缀数组？<br>假设有字符串char c[] = “banana”;和字符指针数组char * a[];<br>令a[0] = &amp;c[0], a[1] = &amp;c[1], a[2] = &amp;c[2]…<br>则a中每个字符串指向的字符串分别为<br>a[0] : banana<br>a[1] : anana<br>a[2] : nana<br>a[3] : ana<br>a[4] : na<br>a[5] : a<br>数组a中的指针包含了字符串中的每一个后缀，因此称为后缀数组。<br>从为文件中读取字符串时，可以这样初始化a和c<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 5000000</span></div><div class="line"><span class="keyword">char</span> c[MAXN], *a[MAXN];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">init</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> n = <span class="number">0</span>;</div><div class="line">    <span class="keyword">char</span> ch;</div><div class="line">    <span class="keyword">while</span>((ch = getchar()) != EOF)</div><div class="line">    &#123;</div><div class="line">        a[n] = &amp;c[n];</div><div class="line">        c[n++] = ch;</div><div class="line">    &#125;</div><div class="line">    c[n] = <span class="string">'\0'</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>执行指令(参考第二章中的做法)test.exe &lt; in.txt &gt; out.txt</p>
<ol>
<li>排序数组a<br>如果某个字符串在数组c中出现两次，那么他将出现在两个不同的后缀中，因此对数组排序以寻找相同的后缀（参考2.4），以”banana”为例，排序后a为<br>a[0] : a<br>a[1] : ana<br>a[2] : anana<br>a[3] : banana<br>a[4] : na<br>a[5] : nana<br>这样就可以扫描a，比较相邻元素来找出最长的重复字符串</li>
</ol>
<p>** 小插曲：使用qsort排序字符串数组和字符指针数组的不同<br>参考<a href="https://www.cnblogs.com/sjy123/p/3287817.html" target="_blank" rel="external">qsort用法</a><br>字符串数组<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">arrstrcmp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *x, <span class="keyword">const</span> <span class="keyword">void</span> *y)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="comment">//这里传入的每个x类型其实为字符串数组类型，所以强转为char*即可</span></div><div class="line">    <span class="keyword">return</span> <span class="built_in">strcmp</span>((<span class="keyword">char</span> *)x, (<span class="keyword">char</span> *)y);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> n = <span class="number">6</span>;</div><div class="line"><span class="keyword">char</span> s[n][<span class="number">7</span>] = &#123;<span class="string">"banana"</span>, <span class="string">"anana"</span>, <span class="string">"nana"</span>, <span class="string">"ana"</span>, <span class="string">"na"</span>, <span class="string">"a"</span>&#125;;</div><div class="line"><span class="comment">//打印typeid(s[0])可知，s[0]的类型为char[7]，长度自然为7</span></div><div class="line">qsort(s, n, <span class="keyword">sizeof</span>(s[<span class="number">0</span>]), arrstrcmp);</div><div class="line"><span class="comment">//a, ana, anana, banana, na, nana</span></div></pre></td></tr></table></figure></p>
<p>这其中应该有不少字符串拷贝，消耗较大</p>
<p>字符串指针数组<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">pstrcmp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *x, <span class="keyword">const</span> <span class="keyword">void</span> *y)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="comment">//这里传过来的每一项应该是字符串指针</span></div><div class="line">    <span class="keyword">return</span> <span class="built_in">strcmp</span>(*(<span class="keyword">char</span> **)x , *(<span class="keyword">char</span> **)y);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">char</span> *s[n] = &#123;<span class="string">"banana"</span>, <span class="string">"anana"</span>, <span class="string">"nana"</span>, <span class="string">"ana"</span>, <span class="string">"na"</span>, <span class="string">"a"</span>&#125;;</div><div class="line"><span class="comment">//打印typeid(s[0])可知，s[0]的类型为char*，长度为1</span></div><div class="line">qsort(s, n, <span class="keyword">sizeof</span>(s[<span class="number">0</span>]), pstrcmp);</div></pre></td></tr></table></figure></p>
<p>这其中应该只是指针的变化，消耗较小</p>
<p>由上面的讨论可知，本例中的数组a显然是后一种类型</p>
<ol>
<li>扫描数组a，查找相邻元素的重复字符串<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//扫描数组a</span></div><div class="line">    int maxlen = <span class="number">-1</span>, maxi = <span class="number">0</span>, thislen = <span class="number">0</span>;</div><div class="line">    for(int i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; ++i)</div><div class="line">    &#123;</div><div class="line">        if((thislen = comlen(a[i], a[i + <span class="number">1</span>])) &gt; maxlen)</div><div class="line">        &#123;</div><div class="line">            maxlen = thislen;</div><div class="line">            maxi = i;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    printf(<span class="string">"max sub is %.*s<span class="subst">\n</span>"</span>, maxlen, a[maxi]);</div></pre></td></tr></table></figure>
</li>
</ol>
<p>注意点：可以在printf语句使用” * “精度输出字符串maxlen个字符。闻所未闻啊！！</p>
<ul>
<li>查找不包含重复字符的最长子串<br>这个是想到的之前遇到的一个面试题，和本章其实没什么关系，只是题目名字有点相似<br>例如”abcbcdeda”，则最长子串为”bcde”</li>
</ul>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//check src[begin..end] has the same char with ch</span></div><div class="line"><span class="keyword">bool</span> contains(<span class="keyword">const</span> <span class="keyword">char</span> *src, <span class="keyword">int</span> <span class="built_in">begin</span>, <span class="keyword">int</span> <span class="built_in">end</span>, <span class="keyword">char</span> ch)</div><div class="line">&#123;</div><div class="line">    <span class="built_in">for</span>(<span class="keyword">int</span> i = <span class="built_in">begin</span>; i &lt;= <span class="built_in">end</span>; ++i)</div><div class="line">        <span class="built_in">if</span>(src[i] == ch)</div><div class="line">            <span class="built_in">return</span> true;</div><div class="line">    <span class="built_in">return</span> false;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> findMaxSub(<span class="keyword">const</span> <span class="keyword">char</span> *src)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> <span class="built_in">size</span> = strlen(src);</div><div class="line">    <span class="built_in">if</span>(<span class="built_in">size</span> == <span class="number">0</span>)</div><div class="line">    &#123;</div><div class="line">        printf(<span class="string">"str is empty\n"</span>);</div><div class="line">        <span class="built_in">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> maxlen = <span class="number">1</span>, thislen, maxi = <span class="number">0</span>;</div><div class="line">    <span class="built_in">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">size</span> - <span class="number">1</span>; ++i)</div><div class="line">    &#123;</div><div class="line">        thislen = <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> j = i;</div><div class="line">        <span class="built_in">while</span>(j &lt; <span class="built_in">size</span> - <span class="number">1</span> &amp;&amp; !contains(src, i, j, src[j + <span class="number">1</span>]))</div><div class="line">        &#123;</div><div class="line">            j++;</div><div class="line">            <span class="built_in">if</span>(j - i + <span class="number">1</span> &gt; maxlen)</div><div class="line">            &#123;</div><div class="line">                maxlen = j - i + <span class="number">1</span>;</div><div class="line">                maxi = i;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    printf(<span class="string">"max substr:%.*s\n"</span>, maxlen, src + maxi);       </div><div class="line">&#125;</div><div class="line"></div><div class="line">findMaxSub(<span class="string">"abcbcdedacgb"</span>);   <span class="comment">//edacgb</span></div><div class="line">findMaxSub(<span class="string">"bcad"</span>);           <span class="comment">//bcad</span></div><div class="line">findMaxSub(<span class="string">"abcadc"</span>);         <span class="comment">//bcad</span></div><div class="line">findMaxSub(<span class="string">"aaaa"</span>);           <span class="comment">//a</span></div><div class="line">findMaxSub(<span class="string">""</span>);               <span class="comment">//str is empty</span></div></pre></td></tr></table></figure>
<p>效率不甚高啊，再想想有没有优化的方法</p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/编程/">编程</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/C/">C++</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://yoursite.com/2018/01/25/编程珠玑学习笔记/" data-title="编程珠玑学习笔记 | 飞翔的pig" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2018/01/27/循环移位问题解析/" title="循环移位问题解析">
  <strong>上一篇：</strong><br/>
  <span>
  循环移位问题解析</span>
</a>
</div>


<div class="next">
<a href="/2018/01/21/几种语言实现socket例子/"  title="几种语言实现socket例子">
 <strong>下一篇：</strong><br/> 
 <span>几种语言实现socket例子
</span>
</a>
</div>

</nav>

	


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#第一章"><span class="toc-number">1.</span> <span class="toc-text">第一章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#开篇题目"><span class="toc-number">1.1.</span> <span class="toc-text">开篇题目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#描述"><span class="toc-number">1.1.1.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解答"><span class="toc-number">1.1.2.</span> <span class="toc-text">解答</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#生成0到n之间k个不同的随机顺序的随机整数"><span class="toc-number">1.2.</span> <span class="toc-text">生成0到n之间k个不同的随机顺序的随机整数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第二章"><span class="toc-number">2.</span> <span class="toc-text">第二章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#问题1"><span class="toc-number">2.1.</span> <span class="toc-text">问题1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#描述-1"><span class="toc-number">2.1.1.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解题思路"><span class="toc-number">2.1.2.</span> <span class="toc-text">解题思路</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#问题2"><span class="toc-number">2.2.</span> <span class="toc-text">问题2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#问题3"><span class="toc-number">2.3.</span> <span class="toc-text">问题3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#描述-2"><span class="toc-number">2.3.1.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解题思路-1"><span class="toc-number">2.3.2.</span> <span class="toc-text">解题思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#几点感想"><span class="toc-number">2.3.3.</span> <span class="toc-text">几点感想</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第三章"><span class="toc-number">3.</span> <span class="toc-text">第三章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#k阶常系数方程计算"><span class="toc-number">3.1.</span> <span class="toc-text">k阶常系数方程计算</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#描述-3"><span class="toc-number">3.1.1.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#实现"><span class="toc-number">3.1.2.</span> <span class="toc-text">实现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第四章"><span class="toc-number">4.</span> <span class="toc-text">第四章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#二分搜索的讨论"><span class="toc-number">4.1.</span> <span class="toc-text">二分搜索的讨论</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#实现-1"><span class="toc-number">4.1.1.</span> <span class="toc-text">实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#与chromium源码比较"><span class="toc-number">4.1.2.</span> <span class="toc-text">与chromium源码比较</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第八章"><span class="toc-number">5.</span> <span class="toc-text">第八章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#最大子序列求解问题"><span class="toc-number">5.1.</span> <span class="toc-text">最大子序列求解问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#描述-4"><span class="toc-number">5.1.1.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解答-1"><span class="toc-number">5.1.2.</span> <span class="toc-text">解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#伪代码"><span class="toc-number">5.1.3.</span> <span class="toc-text">伪代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#发散一下"><span class="toc-number">5.1.4.</span> <span class="toc-text">发散一下</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#习题5"><span class="toc-number">5.2.</span> <span class="toc-text">习题5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#习题9"><span class="toc-number">5.3.</span> <span class="toc-text">习题9</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#说明"><span class="toc-number">5.3.1.</span> <span class="toc-text">说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#实现-2"><span class="toc-number">5.3.2.</span> <span class="toc-text">实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#习题10"><span class="toc-number">5.4.</span> <span class="toc-text">习题10</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#说明-1"><span class="toc-number">5.4.1.</span> <span class="toc-text">说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#实现-3"><span class="toc-number">5.4.2.</span> <span class="toc-text">实现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第九章"><span class="toc-number">6.</span> <span class="toc-text">第九章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#顺序搜索"><span class="toc-number">6.1.</span> <span class="toc-text">顺序搜索</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#变形二分搜索：查找数字t在数组中第一次出现的位置"><span class="toc-number">6.2.</span> <span class="toc-text">变形二分搜索：查找数字t在数组中第一次出现的位置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#解决方法"><span class="toc-number">6.2.1.</span> <span class="toc-text">解决方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#宏和函数求最值性能比较"><span class="toc-number">6.3.</span> <span class="toc-text">宏和函数求最值性能比较</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#习题7-求解数的二进制中1的个数"><span class="toc-number">6.4.</span> <span class="toc-text">习题7-求解数的二进制中1的个数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#习题8-查找数组元素的最大值"><span class="toc-number">6.5.</span> <span class="toc-text">习题8-查找数组元素的最大值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#习题12"><span class="toc-number">6.6.</span> <span class="toc-text">习题12</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第10章"><span class="toc-number">7.</span> <span class="toc-text">第10章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-2示例问题"><span class="toc-number">7.1.</span> <span class="toc-text">10.2示例问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#描述-5"><span class="toc-number">7.1.1.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#实现-4"><span class="toc-number">7.1.2.</span> <span class="toc-text">实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#两个对称矩阵的压缩"><span class="toc-number">7.2.</span> <span class="toc-text">两个对称矩阵的压缩</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#描述-6"><span class="toc-number">7.2.1.</span> <span class="toc-text">描述</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第11章-排序"><span class="toc-number">8.</span> <span class="toc-text">第11章-排序</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#插入排序"><span class="toc-number">8.1.</span> <span class="toc-text">插入排序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#快速排序"><span class="toc-number">8.2.</span> <span class="toc-text">快速排序</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第12章"><span class="toc-number">9.</span> <span class="toc-text">第12章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#两个常用函数"><span class="toc-number">9.1.</span> <span class="toc-text">两个常用函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#题目1：输出随机有序列表"><span class="toc-number">9.2.</span> <span class="toc-text">题目1：输出随机有序列表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#习题"><span class="toc-number">9.3.</span> <span class="toc-text">习题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第13章"><span class="toc-number">10.</span> <span class="toc-text">第13章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#习题-1"><span class="toc-number">10.1.</span> <span class="toc-text">习题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第14章"><span class="toc-number">11.</span> <span class="toc-text">第14章</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第15章"><span class="toc-number">12.</span> <span class="toc-text">第15章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#单词"><span class="toc-number">12.1.</span> <span class="toc-text">单词</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#短语"><span class="toc-number">12.2.</span> <span class="toc-text">短语</span></a></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  


  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/《算法导论》/" title="《算法导论》">《算法导论》<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/图解排序算法/" title="图解排序算法">图解排序算法<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/编程/备忘/" title="备忘">备忘<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/常见问题/" title="常见问题">常见问题<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/理财/" title="理财">理财<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/经典算法系列/" title="经典算法系列">经典算法系列<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/编程/" title="编程">编程<sup>32</sup></a></li>
		  
		
		  
			<li><a href="/categories/编程/金融/" title="金融">金融<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/C/" title="C++">C++<sup>21</sup></a></li>
			
		
			
				<li><a href="/tags/Python/" title="Python">Python<sup>11</sup></a></li>
			
		
			
				<li><a href="/tags/算法/" title="算法">算法<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/MySQL/" title="MySQL">MySQL<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/vi/" title="vi">vi<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/IRR/" title="IRR">IRR<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Linux/" title="Linux">Linux<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/单元测试/" title="单元测试">单元测试<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/数据结构/" title="数据结构">数据结构<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/C-11/" title="C++11">C++11<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Web/" title="Web">Web<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/金融/" title="金融">金融<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/排序算法/" title="排序算法">排序算法<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/设计模式/" title="设计模式">设计模式<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/正则表达式/" title="正则表达式">正则表达式<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://github.com" target="_blank" title="一个面向开源及私有软件项目的托管平台">Github</a>
            
          </li>
        
          <li>
            
            	<a href="https://hexo.io" target="_blank" title="一个开源的静态博客生成器">Hexo</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">新浪微博</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=null&verifier=b3593ceb&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m kongdb. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/2785742593" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2019 
		
		<a href="/about" target="_blank" title="Kongdb">Kongdb</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>









<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?b7947db15be98e20e7d2ba6c3ef6ca27";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
